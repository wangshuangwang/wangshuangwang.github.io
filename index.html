<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  <meta name="baidu-site-verification" content="L6Lm9d5Crl">
  
  
  
  
  <title>Swans</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Swans">
<meta property="og:url" content="https://wangshuangwang.github.io/index.html">
<meta property="og:site_name" content="Swans">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Swans">
  
    <link rel="alternative" href="/atom.xml" title="Swans" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  
  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet">
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head></html>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

        <a href="/" class="profilepic">
            
            <img lazy-src="/img/avatar.png" class="js-avatar">
            
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">天纵旺才</a></h1>
        </hgroup>
        
        
            <form>
                <input type="text" class="st-default-search-input search" id="local-search-input" placeholder="搜索一下" autocomplete="off">
            </form>
            <div id="local-search-result"></div>
        
        
            <script type="text/javascript">
                (function() {
                    'use strict';
                    function getMatchData(keyword, data) {
                        var matchData = [];
                        for(var i =0;i<data.length;i++){
                            if(data[i].title.toLowerCase().indexOf(keyword)>=0) 
                                matchData.push(data[i])
                        }
                        return matchData;
                    }
                    var $input = $('#local-search-input');
                    var $resultContent = $('#local-search-result');
                    $input.keyup(function(){
                        $.ajax({
                            url: '/search.json',
                            dataType: "json",
                            success: function( json ) {
                                var str='<ul class=\"search-result-list\">';                
                                var keyword = $input.val().trim().toLowerCase();
                                $resultContent.innerHTML = "";
                                if ($input.val().trim().length <= 0) {
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                }
                                var results = getMatchData(keyword, json);
                                if(results.length === 0){
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                } 
                                for(var i =0; i<results.length; i++){
                                    str += "<li><a href='"+ results[i].url +"' class='search-result-title'>"+ results[i].title +"</a></li>";
                                }
                                str += "</ul>";
                                $resultContent.empty();
                                $resultContent.append(str);
                                $('#switch-area').hide();
                            }
                        });
                    });
                })();
            </script>
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        
        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/categories/开发工具/">开发小学徒</a></li>
                        
                            <li><a href="/categories/运维文档/">运维文档</a></li>
                        
                            <li><a href="/categories/书籍推荐/">文艺小青年</a></li>
                        
                            <li><a href="/categories/旅游/">旅游</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl github" target="_blank" href="https://wangshuangwang.github.io" title="github">github</a>
                            
                                <a class="fl weibo" target="_blank" href="https://weibo.com/" title="weibo">weibo</a>
                            
                                <a class="fl rss" target="_blank" href="/atom.xml" title="rss">rss</a>
                            
                        </ul>
                    </nav>
                </section>
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/java中间件工具/" style="font-size: 20px;">java中间件工具</a> <a href="/tags/linux知识块/" style="font-size: 15px;">linux知识块</a> <a href="/tags/书籍/" style="font-size: 10px;">书籍</a> <a href="/tags/运维参考/" style="font-size: 15px;">运维参考</a>
                    </div>
                </section>
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/baidu_21483933">csdn</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://segmentfault.com/blog/maocg_web">segmentfault</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.jianshu.com/users/eb37ef89c746/latest_articles">简书</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://e.xitu.io/">掘金酱</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://evin-an.github.io/">安富强</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://www.gaoyuanzhi.xyz">远志</a>
                    
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">爱动漫,爱游戏,爱编程,爱运动,爱的太多了!</div>
                </section>
                
            </div>
        </div>
    </header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">天纵旺才</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/avatar.png" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">天纵旺才</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/categories/开发工具/">开发小学徒</a></li>
                
                    <li><a href="/categories/运维文档/">运维文档</a></li>
                
                    <li><a href="/categories/书籍推荐/">文艺小青年</a></li>
                
                    <li><a href="/categories/旅游/">旅游</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="github" target="_blank" href="https://wangshuangwang.github.io" title="github">github</a>
                    
                        <a class="weibo" target="_blank" href="https://weibo.com/" title="weibo">weibo</a>
                    
                        <a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
                    
                </div>
            </nav>
        </header>
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-linux常用命令" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/22/linux常用命令/" class="article-date">
      <time datetime="2019-03-22T01:58:30.000Z" itemprop="datePublished">2019-03-22</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/22/linux常用命令/">linux常用命令</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h2 id="一、查看端口的命令"><a href="#一、查看端口的命令" class="headerlink" title="一、查看端口的命令"></a>一、查看端口的命令</h2><h3 id="1-netstat命令各参数说明"><a href="#1-netstat命令各参数说明" class="headerlink" title="1.netstat命令各参数说明"></a>1.netstat命令各参数说明</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 指明显示TCP端口</span><br><span class="line">netstat -t</span><br><span class="line"># 指明显示UDP端口</span><br><span class="line">netstat -u</span><br><span class="line"># 仅显示监听套接字</span><br><span class="line">netstat -l</span><br><span class="line"># 显示进程标识符和程序名称，每一个套接字/端口都属于一个程序</span><br><span class="line">netstat -p</span><br><span class="line"># 不进行DNS轮询，显示IP</span><br><span class="line">netstat -n</span><br><span class="line"># 查看当前所有tcp端口</span><br><span class="line">netstat -ntlp</span><br><span class="line"># 查看所有80端口使用情况</span><br><span class="line">netstat -ntulp |grep 80</span><br></pre></td></tr></table></figure>
<h2 id="2-lsof下查看程序端口"><a href="#2-lsof下查看程序端口" class="headerlink" title="2.lsof下查看程序端口"></a>2.lsof下查看程序端口</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 查看tomcat端口占用情况，查出进程号</span><br><span class="line">ps -aux | grep tomcat</span><br><span class="line"># 查看所有的进程和端口使用情况</span><br><span class="line">netstat -apn</span><br><span class="line">netstat -anp|grep 8080</span><br><span class="line">查看端口占用情况</span><br><span class="line">lsof -i :8080</span><br><span class="line">netstat -ntulp | grep 8080</span><br></pre></td></tr></table></figure>
<h2 id="二、压缩、解压命令"><a href="#二、压缩、解压命令" class="headerlink" title="二、压缩、解压命令"></a>二、压缩、解压命令</h2><h3 id="1-tar命令"><a href="#1-tar命令" class="headerlink" title="1.tar命令"></a>1.tar命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">解压：tar xzvf filename (不想看文件可通过：tar xzf filename)</span><br><span class="line">压缩：tar czvf filename.tar.gz   dirname</span><br></pre></td></tr></table></figure>
<h3 id="2-gz命令"><a href="#2-gz命令" class="headerlink" title="2.gz命令"></a>2.gz命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">解压１：gunzip filename.gz</span><br><span class="line">解压２：gzip -d filename.gz</span><br><span class="line">压缩：gzip filename</span><br></pre></td></tr></table></figure>
<h3 id="3-tar-gz和-tgz"><a href="#3-tar-gz和-tgz" class="headerlink" title="3..tar.gz和.tgz"></a>3..tar.gz和.tgz</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">解压：tar zxvf filename.tar.gz</span><br><span class="line">      压缩：tar zcvf filename.tar.gz dirname</span><br><span class="line">      压缩多个文件：tar zcvf filename.tar.gz dirname1 dirname2 dirname3 ...</span><br></pre></td></tr></table></figure>
<h2 id="三、服务器各项状态"><a href="#三、服务器各项状态" class="headerlink" title="三、服务器各项状态"></a>三、服务器各项状态</h2><h3 id="1-查看服务器"><a href="#1-查看服务器" class="headerlink" title="1.查看服务器"></a>1.查看服务器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 查看cpu的个数</span><br><span class="line">cat /proc/cpuinfo | grep &quot;processor&quot;</span><br><span class="line"># 如果个数太多，可以用以下命令</span><br><span class="line">cat /proc/cpuinfo | grep &quot;processor&quot;|wc -l</span><br><span class="line"># 查看服务器的内存大小</span><br><span class="line">cat /proc/meminfo | grep MemTotal </span><br><span class="line"># 查看服务器硬盘大小</span><br><span class="line">df -hl</span><br></pre></td></tr></table></figure>
<h3 id="2-文件夹命令"><a href="#2-文件夹命令" class="headerlink" title="2.文件夹命令"></a>2.文件夹命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 查看文件夹的大小命令</span><br><span class="line">进入文件夹执行 du -sh</span><br><span class="line"># 默认情况下按2次tab键才会出现提示，现在只需要按一次</span><br><span class="line">set show-all-if-ambiguous on</span><br><span class="line"># 不显示隐藏文件，特别是当你在Home目录时，自己会觉得眼前比较干净</span><br><span class="line">set match-hidden-files off</span><br><span class="line"># 自动补全时忽略大小写</span><br><span class="line">set completion-ignore-case on</span><br><span class="line"># 输入某个命令的一部分时，按上下箭头，会匹配关于这个命令的最近的使用历史</span><br><span class="line">&quot;\e[A&quot;: history-search-backward    &quot;\e[B&quot;: history-search-forward</span><br><span class="line">以上配置都在~/.bashrc或~/.inputrc</span><br></pre></td></tr></table></figure>
<h2 id="四、screen命令"><a href="#四、screen命令" class="headerlink" title="四、screen命令"></a>四、screen命令</h2><h3 id="1-背景"><a href="#1-背景" class="headerlink" title="1.背景"></a>1.背景</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">系统管理员经常需要SSH 或者telent 远程登录到Linux 服务器，经常运行一些需要很长时间才能完成的任务，比如系统备份、ftp 传输等等。通常情况下我们都是为每一个这样的任务开一个远程终端窗口，因为它们执行的时间太长了。必须等待它们执行完毕，在此期间不能关掉窗口或者断开连接，否则这个任务就会被杀掉，一切半途而废了。</span><br></pre></td></tr></table></figure>
<h3 id="2-简介"><a href="#2-简介" class="headerlink" title="2.简介"></a>2.简介</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GNU Screen是一款由GNU计划开发的用于命令行终端切换的自由软件。用户可以通过该软件同时连接多个本地或远程的命令行会话，并在其间自由切换</span><br></pre></td></tr></table></figure>
<h4 id="1）会话恢复"><a href="#1）会话恢复" class="headerlink" title="1）会话恢复"></a>1）会话恢复</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">只要Screen本身没有终止，在其内部运行的会话都可以恢复。这一点对于远程登录的用户特别有用——即使网络连接中断，用户也不会失去对已经打开的命令行会话的控制。只要再次登录到主机上执行screen -r就可以恢复会话的运行。同样在暂时离开的时候，也可以执行分离命令detach，在保证里面的程序正常运行的情况下让Screen挂起（切换到后台）。这一点和图形界面下的VNC很相似。</span><br></pre></td></tr></table></figure>
<h4 id="2）多窗口"><a href="#2）多窗口" class="headerlink" title="2）多窗口"></a>2）多窗口</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在Screen环境下，所有的会话都独立的运行，并拥有各自的编号、输入、输出和窗口缓存。用户可以通过快捷键在不同的窗口下切换，并可以自由的重定向各个窗口的输入和输出。Screen实现了基本的文本操作，如复制粘贴等；还提供了类似滚动条的功能，可以查看窗口状况的历史记录。窗口还可以被分区和命名，还可以监视后台窗口的活动。</span><br></pre></td></tr></table></figure>
<h4 id="3）会话共享"><a href="#3）会话共享" class="headerlink" title="3）会话共享"></a>3）会话共享</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Screen可以让一个或多个用户从不同终端多次登录一个会话，并共享会话的所有特性（比如可以看到完全相同的输出）。它同时提供了窗口访问权限的机制，可以对窗口进行密码保护</span><br></pre></td></tr></table></figure>
<h3 id="3-screen-常用参数"><a href="#3-screen-常用参数" class="headerlink" title="3.screen 常用参数"></a>3.screen 常用参数</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#  新建一个叫yourname的session</span><br><span class="line">screen -S yourname</span><br><span class="line"># 列出当前所有的session</span><br><span class="line">screen -ls</span><br><span class="line"># 回到yourname这个session</span><br><span class="line">screen -r yourname</span><br><span class="line"># 远程detach某个session</span><br><span class="line">screen -d yourname</span><br><span class="line"># 结束当前session并回到yourname这个session</span><br><span class="line">screen -d -r yourname</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux知识块/">linux知识块</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-nginx配置" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/21/nginx配置/" class="article-date">
      <time datetime="2019-03-21T08:58:30.000Z" itemprop="datePublished">2019-03-21</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/21/nginx配置/">nginx配置</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h2 id="一、nginx图片说明"><a href="#一、nginx图片说明" class="headerlink" title="一、nginx图片说明"></a>一、nginx图片说明</h2><h3 id="1-全局块"><a href="#1-全局块" class="headerlink" title="1.全局块"></a>1.全局块</h3><h3 id="2-events块"><a href="#2-events块" class="headerlink" title="2.events块"></a>2.events块</h3><h3 id="3-http块"><a href="#3-http块" class="headerlink" title="3.http块"></a>3.http块</h3><h3 id="4-server块"><a href="#4-server块" class="headerlink" title="4.server块"></a>4.server块</h3><h3 id="5-location块"><a href="#5-location块" class="headerlink" title="5.location块"></a>5.location块</h3><h3 id="6-具体图片"><a href="#6-具体图片" class="headerlink" title="6.具体图片"></a>6.具体图片</h3><p><img src="/images/nginx7.png" alt="nginx7"></p>
<p><img src="/images/nginx6.png" alt="nginx6"></p>
<h2 id="六、nginx介绍"><a href="#六、nginx介绍" class="headerlink" title="六、nginx介绍"></a>六、nginx介绍</h2><h3 id="1-概述"><a href="#1-概述" class="headerlink" title="1.概述"></a>1.概述</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx是一款自由的、开源的、高性能的HTTP服务器和反向代理服务器；同时也是一个IMAP、POP3、SMTP代理服务器；nginx可以作为一个HTTP服务器进行网站的发布处理，另外nginx可以作为反向代理进行负载均衡的实现</span><br></pre></td></tr></table></figure>
<p><img src="/images/nginx1.png" alt="nginx1"></p>
<h3 id="2-反向代理"><a href="#2-反向代理" class="headerlink" title="2.反向代理"></a>2.反向代理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">此时就设计到两个角色，一个是被代理角色，一个是目标角色，被代理角色通过这个代理访问目标角色完成一些任务的过程称为代理操作过程；如同生活中的专卖店~客人到adidas专卖店买了一双鞋，这个专卖店就是代理，被代理角色就是adidas厂家，目标角色就是用户</span><br><span class="line">反向代理中，proxy和server同属于一个LAN，对client透明</span><br><span class="line">实际上proxy在两种代理中做的事都是代为收发请求和响应，不过从结构上来看正好左右互换了下，所以把后出现的那种方式称之为反向代理</span><br></pre></td></tr></table></figure>
<h4 id="1）保证内网的安全，可以使用反向代理提供WAF功能，组织WEB攻击"><a href="#1）保证内网的安全，可以使用反向代理提供WAF功能，组织WEB攻击" class="headerlink" title="1）保证内网的安全，可以使用反向代理提供WAF功能，组织WEB攻击"></a>1）保证内网的安全，可以使用反向代理提供WAF功能，组织WEB攻击</h4><p><img src="/images/nginx3.png" alt="nginx3"></p>
<h4 id="2）负载均衡，通过反向代理服务器来优化网站的负载"><a href="#2）负载均衡，通过反向代理服务器来优化网站的负载" class="headerlink" title="2）负载均衡，通过反向代理服务器来优化网站的负载"></a>2）负载均衡，通过反向代理服务器来优化网站的负载</h4><p><img src="/images/nginx4.png" alt="nginx4"></p>
<h3 id="3-正向代理"><a href="#3-正向代理" class="headerlink" title="3.正向代理"></a>3.正向代理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">含义：我是一个用户，我访问不了某网站，但是我能访问一个代理服务器，这个代理服务器呢,他能访问那个我不能访问的网站，于是我先连上代理服务器,告诉他我需要那个无法访问网站的内容，代理服务器去取回来,然后返回给我。</span><br><span class="line">*********正向代理中，proxy和client同属于一个LAN，对server透明**********</span><br><span class="line">用途：访问原来无法访问的资源</span><br><span class="line">      可以做缓存，加速访问资源</span><br><span class="line">      对客户访问进行授权，上网进行认证</span><br><span class="line">      代理可以记录用户访问记录，（对外隐藏用户信息）</span><br></pre></td></tr></table></figure>
<p><img src="/images/nginx2.png" alt="nginx2"></p>
<h3 id="4-细心网友的图片"><a href="#4-细心网友的图片" class="headerlink" title="4.细心网友的图片"></a>4.细心网友的图片</h3><p><img src="/images/nginx5.png" alt="nginx5"></p>
<h2 id="七、搭建nginx反向代理用做内网转发"><a href="#七、搭建nginx反向代理用做内网转发" class="headerlink" title="七、搭建nginx反向代理用做内网转发"></a>七、搭建nginx反向代理用做内网转发</h2><h3 id="1-应用场景"><a href="#1-应用场景" class="headerlink" title="1.应用场景"></a>1.应用场景</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">内网有多台服务器的http服务要映射到外网静态ip，此时在内网搭建nginx反向代理服务器，将nginx反向代理服务器的80映射到外网ip的80，因此指向到公司外网ip的域名的HTTP请求就会发送到nginx反向代理服务器，利用nginx反向代理将不同域名的请求转发给内网不同机器端口</span><br></pre></td></tr></table></figure>
<h3 id="2-nginx编译安装"><a href="#2-nginx编译安装" class="headerlink" title="2.nginx编译安装"></a>2.nginx编译安装</h3><h4 id="1）基于APT源安装"><a href="#1）基于APT源安装" class="headerlink" title="1）基于APT源安装"></a>1）基于APT源安装</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># 安装nginx服务</span><br><span class="line">sudo apt-get install nginx</span><br><span class="line">安装完成文件位置说明</span><br><span class="line"># 主程序</span><br><span class="line">/usr/sbin/nginx</span><br><span class="line"># 存放配置文件</span><br><span class="line">/etc/nginx</span><br><span class="line"># 存放静态文件</span><br><span class="line">/usr/share/nginx</span><br><span class="line"># 存放日志</span><br><span class="line">/var/log/nginx</span><br><span class="line"># nginx配置文件</span><br><span class="line">/etc/nginx/nginx.conf</span><br><span class="line"># 查看nginx加载的哪个配置文件</span><br><span class="line">sudo nginx -t或者ps -ef | grep nginx</span><br><span class="line"># nginx启动命令</span><br><span class="line">sudo service nginx &#123;start|stop|restart|reload|force-reload|status|configtest|rotate|upgrade&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2）通过源码包编译安装"><a href="#2）通过源码包编译安装" class="headerlink" title="2）通过源码包编译安装"></a>2）通过源码包编译安装</h4><p>安装gcc g++的依赖库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install build-essential</span><br><span class="line">sudo apt-get install libtool</span><br></pre></td></tr></table></figure>
<p>安装pcre依赖库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install libpcre3 libpcre3-dev</span><br></pre></td></tr></table></figure>
<p>安装zlib依赖库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install zlib1g-dev</span><br></pre></td></tr></table></figure>
<p>安装SSL依赖库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install openssl</span><br></pre></td></tr></table></figure>
<p>安装nginx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#下载最新版本：</span><br><span class="line">wget http://nginx.org/download/nginx-1.13.6.tar.gz</span><br><span class="line">#解压：</span><br><span class="line">tar -zxvf nginx-1.13.6.tar.gz</span><br><span class="line">#进入解压目录：</span><br><span class="line">cd nginx-1.13.6</span><br><span class="line">#配置：</span><br><span class="line">./configure --prefix=/usr/local/nginx </span><br><span class="line">#编译：</span><br><span class="line">make</span><br><span class="line">#安装：</span><br><span class="line">sudo make install</span><br><span class="line">#启动：</span><br><span class="line">sudo /usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf</span><br><span class="line">注意：-c 指定配置文件的路径，不加的话，nginx会自动加载默认路径的配置文件，可以通过-h查看帮助命令。</span><br><span class="line">#查看进程：</span><br><span class="line">ps -ef | grep nginx</span><br></pre></td></tr></table></figure>
<p>配置软连接</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ln -s /usr/local/nginx/sbin/nginx /usr/bin/nginx     （先不不用路径直接输入nginx启动）</span><br></pre></td></tr></table></figure>
<p>配置开机服务自启：在/etc/init.d/下创建nginx文件，sudo vim /etc/init.d/nginx，内容如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line"></span><br><span class="line">### BEGIN INIT INFO</span><br><span class="line"># Provides:      nginx</span><br><span class="line"># Required-Start:    $local_fs $remote_fs $network $syslog $named</span><br><span class="line"># Required-Stop:     $local_fs $remote_fs $network $syslog $named</span><br><span class="line"># Default-Start:     2 3 4 5</span><br><span class="line"># Default-Stop:      0 1 6</span><br><span class="line"># Short-Description: starts the nginx web server</span><br><span class="line"># Description:       starts nginx using start-stop-daemon</span><br><span class="line">### END INIT INFO</span><br><span class="line"></span><br><span class="line">PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin</span><br><span class="line">DAEMON=/usr/local/nginx/sbin/nginx</span><br><span class="line">NAME=nginx</span><br><span class="line">DESC=nginx</span><br><span class="line"></span><br><span class="line"># Include nginx defaults if available</span><br><span class="line">if [ -r /etc/default/nginx ]; then</span><br><span class="line">    . /etc/default/nginx</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">STOP_SCHEDULE=&quot;$&#123;STOP_SCHEDULE:-QUIT/5/TERM/5/KILL/5&#125;&quot;</span><br><span class="line"></span><br><span class="line">test -x $DAEMON || exit 0</span><br><span class="line"></span><br><span class="line">. /lib/init/vars.sh</span><br><span class="line">. /lib/lsb/init-functions</span><br><span class="line"></span><br><span class="line"># Try to extract nginx pidfile</span><br><span class="line">PID=$(cat /usr/local/nginx/conf/nginx.conf | grep -Ev &apos;^\s*#&apos; | awk &apos;BEGIN &#123; RS=&quot;[;&#123;&#125;]&quot; &#125; &#123; if ($1 == &quot;pid&quot;) print $2 &#125;&apos; | head -n1)</span><br><span class="line">if [ -z &quot;$PID&quot; ]; then</span><br><span class="line">    PID=/run/nginx.pid</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">if [ -n &quot;$ULIMIT&quot; ]; then</span><br><span class="line">    # Set ulimit if it is set in /etc/default/nginx</span><br><span class="line">    ulimit $ULIMIT</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">start_nginx() &#123;</span><br><span class="line">    # Start the daemon/service</span><br><span class="line">    #</span><br><span class="line">    # Returns:</span><br><span class="line">    #   0 if daemon has been started</span><br><span class="line">    #   1 if daemon was already running</span><br><span class="line">    #   2 if daemon could not be started</span><br><span class="line">    start-stop-daemon --start --quiet --pidfile $PID --exec $DAEMON --test &gt; /dev/null \</span><br><span class="line">        || return 1</span><br><span class="line">    start-stop-daemon --start --quiet --pidfile $PID --exec $DAEMON -- \</span><br><span class="line">        $DAEMON_OPTS 2&gt;/dev/null \</span><br><span class="line">        || return 2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test_config() &#123;</span><br><span class="line">    # Test the nginx configuration</span><br><span class="line">    $DAEMON -t $DAEMON_OPTS &gt;/dev/null 2&gt;&amp;1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">stop_nginx() &#123;</span><br><span class="line">    # Stops the daemon/service</span><br><span class="line">    #</span><br><span class="line">    # Return</span><br><span class="line">    #   0 if daemon has been stopped</span><br><span class="line">    #   1 if daemon was already stopped</span><br><span class="line">    #   2 if daemon could not be stopped</span><br><span class="line">    #   other if a failure occurred</span><br><span class="line">    start-stop-daemon --stop --quiet --retry=$STOP_SCHEDULE --pidfile $PID --name $NAME</span><br><span class="line">    RETVAL=&quot;$?&quot;</span><br><span class="line">    sleep 1</span><br><span class="line">    return &quot;$RETVAL&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">reload_nginx() &#123;</span><br><span class="line">    # Function that sends a SIGHUP to the daemon/service</span><br><span class="line">    start-stop-daemon --stop --signal HUP --quiet --pidfile $PID --name $NAME</span><br><span class="line">    return 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rotate_logs() &#123;</span><br><span class="line">    # Rotate log files</span><br><span class="line">    start-stop-daemon --stop --signal USR1 --quiet --pidfile $PID --name $NAME</span><br><span class="line">    return 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">upgrade_nginx() &#123;</span><br><span class="line">    # Online upgrade nginx executable</span><br><span class="line">    # http://nginx.org/en/docs/control.html</span><br><span class="line">    #</span><br><span class="line">    # Return</span><br><span class="line">    #   0 if nginx has been successfully upgraded</span><br><span class="line">    #   1 if nginx is not running</span><br><span class="line">    #   2 if the pid files were not created on time</span><br><span class="line">    #   3 if the old master could not be killed</span><br><span class="line">    if start-stop-daemon --stop --signal USR2 --quiet --pidfile $PID --name $NAME; then</span><br><span class="line">        # Wait for both old and new master to write their pid file</span><br><span class="line">        while [ ! -s &quot;$&#123;PID&#125;.oldbin&quot; ] || [ ! -s &quot;$&#123;PID&#125;&quot; ]; do</span><br><span class="line">            cnt=`expr $cnt + 1`</span><br><span class="line">            if [ $cnt -gt 10 ]; then</span><br><span class="line">                return 2</span><br><span class="line">            fi</span><br><span class="line">            sleep 1</span><br><span class="line">        done</span><br><span class="line">        # Everything is ready, gracefully stop the old master</span><br><span class="line">        if start-stop-daemon --stop --signal QUIT --quiet --pidfile &quot;$&#123;PID&#125;.oldbin&quot; --name $NAME; then</span><br><span class="line">            return 0</span><br><span class="line">        else</span><br><span class="line">            return 3</span><br><span class="line">        fi</span><br><span class="line">    else</span><br><span class="line">        return 1</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">case &quot;$1&quot; in</span><br><span class="line">    start)</span><br><span class="line">        log_daemon_msg &quot;Starting $DESC&quot; &quot;$NAME&quot;</span><br><span class="line">        start_nginx</span><br><span class="line">        case &quot;$?&quot; in</span><br><span class="line">            0|1) log_end_msg 0 ;;</span><br><span class="line">            2)   log_end_msg 1 ;;</span><br><span class="line">        esac</span><br><span class="line">        ;;</span><br><span class="line">    stop)</span><br><span class="line">        log_daemon_msg &quot;Stopping $DESC&quot; &quot;$NAME&quot;</span><br><span class="line">        stop_nginx</span><br><span class="line">        case &quot;$?&quot; in</span><br><span class="line">            0|1) log_end_msg 0 ;;</span><br><span class="line">            2)   log_end_msg 1 ;;</span><br><span class="line">        esac</span><br><span class="line">        ;;</span><br><span class="line">    restart)</span><br><span class="line">        log_daemon_msg &quot;Restarting $DESC&quot; &quot;$NAME&quot;</span><br><span class="line"></span><br><span class="line">        # Check configuration before stopping nginx</span><br><span class="line">        if ! test_config; then</span><br><span class="line">            log_end_msg 1 # Configuration error</span><br><span class="line">            exit $?</span><br><span class="line">        fi</span><br><span class="line"></span><br><span class="line">        stop_nginx</span><br><span class="line">        case &quot;$?&quot; in</span><br><span class="line">            0|1)</span><br><span class="line">                start_nginx</span><br><span class="line">                case &quot;$?&quot; in</span><br><span class="line">                    0) log_end_msg 0 ;;</span><br><span class="line">                    1) log_end_msg 1 ;; # Old process is still running</span><br><span class="line">                    *) log_end_msg 1 ;; # Failed to start</span><br><span class="line">                esac</span><br><span class="line">                ;;</span><br><span class="line">            *)</span><br><span class="line">                # Failed to stop</span><br><span class="line">                log_end_msg 1</span><br><span class="line">                ;;</span><br><span class="line">        esac</span><br><span class="line">        ;;</span><br><span class="line">    reload|force-reload)</span><br><span class="line">        log_daemon_msg &quot;Reloading $DESC configuration&quot; &quot;$NAME&quot;</span><br><span class="line"></span><br><span class="line">        # Check configuration before stopping nginx</span><br><span class="line">        #</span><br><span class="line">        # This is not entirely correct since the on-disk nginx binary</span><br><span class="line">        # may differ from the in-memory one, but that&apos;s not common.</span><br><span class="line">        # We prefer to check the configuration and return an error</span><br><span class="line">        # to the administrator.</span><br><span class="line">        if ! test_config; then</span><br><span class="line">            log_end_msg 1 # Configuration error</span><br><span class="line">            exit $?</span><br><span class="line">        fi</span><br><span class="line"></span><br><span class="line">        reload_nginx</span><br><span class="line">        log_end_msg $?</span><br><span class="line">        ;;</span><br><span class="line">    configtest|testconfig)</span><br><span class="line">        log_daemon_msg &quot;Testing $DESC configuration&quot;</span><br><span class="line">        test_config</span><br><span class="line">        log_end_msg $?</span><br><span class="line">        ;;</span><br><span class="line">    status)</span><br><span class="line">        status_of_proc -p $PID &quot;$DAEMON&quot; &quot;$NAME&quot; &amp;&amp; exit 0 || exit $?</span><br><span class="line">        ;;</span><br><span class="line">    upgrade)</span><br><span class="line">        log_daemon_msg &quot;Upgrading binary&quot; &quot;$NAME&quot;</span><br><span class="line">        upgrade_nginx</span><br><span class="line">        log_end_msg $?</span><br><span class="line">        ;;</span><br><span class="line">    rotate)</span><br><span class="line">        log_daemon_msg &quot;Re-opening $DESC log files&quot; &quot;$NAME&quot;</span><br><span class="line">        rotate_logs</span><br><span class="line">        log_end_msg $?</span><br><span class="line">        ;;</span><br><span class="line">    *)</span><br><span class="line">        echo &quot;Usage: $NAME &#123;start|stop|restart|reload|force-reload|status|configtest|rotate|upgrade&#125;&quot; &gt;&amp;2</span><br><span class="line">        exit 3</span><br><span class="line">        ;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#设置服务脚本有执行权限</span><br><span class="line">sudo chmod +x /etc/init.d/nginx</span><br><span class="line">#注册服务</span><br><span class="line">cd /etc/init.d/</span><br><span class="line">sudo update-rc.d nginx defaults</span><br></pre></td></tr></table></figure>
<h3 id="3-nginx反向代理基本配置"><a href="#3-nginx反向代理基本配置" class="headerlink" title="3.nginx反向代理基本配置"></a>3.nginx反向代理基本配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen 8080;# default_server;</span><br><span class="line">        server_name localhost;</span><br><span class="line">        charset utf-8;</span><br><span class="line">        rewrite_log on;</span><br><span class="line">        location ^~/testapi/ &#123;</span><br><span class="line">                proxy_redirect off;</span><br><span class="line">                proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">                default_type  application/json;</span><br><span class="line">                #设置默认值</span><br><span class="line">                set $newIp &quot;unkown&quot;;</span><br><span class="line">                #特殊请求过滤</span><br><span class="line">                if ($request_uri ~ /oss\/file\/query$|platform\/version\/main\/check\/update$/|/v1\/setting\/docuser\/avatar\/) &#123;</span><br><span class="line">                        set $newIp &quot;192.168.1.X:9980&quot;;</span><br><span class="line">                        break;</span><br><span class="line">                &#125;</span><br><span class="line">                #老版本请求</span><br><span class="line">                if ($http_appversion = &quot;1.0.16&quot;)&#123;</span><br><span class="line">                        set $newIp &quot;192.168.1.X:9080&quot;;</span><br><span class="line">                        break;</span><br><span class="line">                &#125;</span><br><span class="line">                #新版本请求</span><br><span class="line">                if ($http_appversion = &quot;1.1.0&quot;)&#123;</span><br><span class="line">                        set $newIp &quot;192.168.1.131:9980&quot;;</span><br><span class="line">                        break;</span><br><span class="line">                &#125;</span><br><span class="line">                #新版本请求</span><br><span class="line">                if ($http_appversion = &quot;1.1.3&quot;)&#123;</span><br><span class="line">                        set $newIp &quot;192.168.1.131:9980&quot;;</span><br><span class="line">                        break;</span><br><span class="line">                &#125;</span><br><span class="line">                #未知版本号</span><br><span class="line">                if ($http_appversion != &quot;&quot;)&#123;</span><br><span class="line">                        return 200 &apos;&#123;&quot;success&quot;:false,&quot;code&quot;:-2,&quot;message&quot;:&quot;版本过旧，需要强制升级&quot;,&quot;data&quot;:&quot;&quot;&#125;&apos;;</span><br><span class="line">                &#125;</span><br><span class="line">                #主要适用与未添加版本兼容功能之前的api请求（header中无版本号的情况），走老版本请求地址，以下各版本可去掉此逻辑</span><br><span class="line">                if ($newIp = &quot;unkown&quot;)&#123;</span><br><span class="line">                    set $newIp &quot;192.168.1.X:9080&quot;;</span><br><span class="line">                    break;</span><br><span class="line">                &#125;</span><br><span class="line">                proxy_pass &quot;http://$newIp&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<h3 id="4-nginx代理配置案例"><a href="#4-nginx代理配置案例" class="headerlink" title="4.nginx代理配置案例"></a>4.nginx代理配置案例</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">upstream test_api&#123;</span><br><span class="line"> server 192.168.244.X:8080   </span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">    listen 8080;default_server;</span><br><span class="line">    server_name localhost;</span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://test_api/;</span><br><span class="line">        proxy_http_version 1.1;</span><br><span class="line">        proxy_set_header Upgrade $http_upgrade;</span><br><span class="line">        proxy_set_header Connection &quot;upgrade&quot;;</span><br><span class="line">        proxy_set_header Host $http_host;</span><br><span class="line">        </span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header X-Forward-For $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_set_header X-Forward-Proto http;</span><br><span class="line">        proxy_set_header X-Nginx-Proxy true;</span><br><span class="line">        proxy_redirect off;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5-nginx反向代理配置案例"><a href="#5-nginx反向代理配置案例" class="headerlink" title="5.nginx反向代理配置案例"></a>5.nginx反向代理配置案例</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">#负责压缩数据流</span><br><span class="line">gzip              on;  </span><br><span class="line">gzip_min_length   1000;  </span><br><span class="line">gzip_types        text/plain text/css application/x-javascript;</span><br><span class="line"></span><br><span class="line">#设定负载均衡的服务器列表</span><br><span class="line">#weigth参数表示权值，权值越高被分配到的几率越大</span><br><span class="line">upstream hello&#123;</span><br><span class="line">    server 192.168.68.43:8080 weight=1;</span><br><span class="line">    server 192.168.68.45:8080 weight=1;            </span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line">server &#123;</span><br><span class="line">    #侦听的80端口</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  localhost;</span><br><span class="line">    #设定查看Nginx状态的地址</span><br><span class="line">    location /nginxstatus&#123;</span><br><span class="line">         stub_status on;</span><br><span class="line">         access_log on;</span><br><span class="line">         auth_basic &quot;nginxstatus&quot;;</span><br><span class="line">         auth_basic_user_file htpasswd;</span><br><span class="line">    &#125;</span><br><span class="line">    #匹配以jsp结尾的，tomcat的网页文件是以jsp结尾</span><br><span class="line">    location / &#123;</span><br><span class="line">        index index.jsp;</span><br><span class="line">        proxy_pass   http://hello;    #在这里设置一个代理，和upstream的名字一样</span><br><span class="line">        #以下是一些反向代理的配置可删除</span><br><span class="line">        proxy_redirect             off; </span><br><span class="line">        #后端的Web服务器可以通过X-Forwarded-For获取用户真实IP</span><br><span class="line">        proxy_set_header           Host $host; </span><br><span class="line">        proxy_set_header           X-Real-IP $remote_addr; </span><br><span class="line">        proxy_set_header           X-Forwarded-For $proxy_add_x_forwarded_for; </span><br><span class="line">        client_max_body_size       10m; #允许客户端请求的最大单文件字节数</span><br><span class="line">        client_body_buffer_size    128k; #缓冲区代理缓冲用户端请求的最大字节数</span><br><span class="line">        proxy_connect_timeout      300; #nginx跟后端服务器连接超时时间(代理连接超时)</span><br><span class="line">        proxy_send_timeout         300; #后端服务器数据回传时间(代理发送超时)</span><br><span class="line">        proxy_read_timeout         300; #连接成功后，后端服务器响应时间(代理接收超时)</span><br><span class="line">        proxy_buffer_size          4k; #设置代理服务器（nginx）保存用户头信息的缓冲区大小</span><br><span class="line">        proxy_buffers              4 32k; #proxy_buffers缓冲区，网页平均在32k以下的话，这样设置</span><br><span class="line">        proxy_busy_buffers_size    64k; #高负荷下缓冲大小（proxy_buffers*2）</span><br><span class="line">        proxy_temp_file_write_size 64k; #设定缓存文件夹大小，大于这个值，将从upstream服务器传</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java中间件工具/">java中间件工具</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-rabbitmq使用使用" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/21/rabbitmq使用使用/" class="article-date">
      <time datetime="2019-03-21T03:16:30.000Z" itemprop="datePublished">2019-03-21</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/21/rabbitmq使用使用/">rabbitmq使用使用</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h2 id="一、rabbitmq概念"><a href="#一、rabbitmq概念" class="headerlink" title="一、rabbitmq概念"></a>一、rabbitmq概念</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rabbitmq是流行的开源消息队列系统，是AMQP的标准实现，用elang语言开发，其具有良好的性能和时效性，同时也能够非常好的支持集群和负载部署，适合大规模的分布式系统部署</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rabbit模式大概分为以下三种：单一模式、普通模式、镜像模式</span><br></pre></td></tr></table></figure>
<h3 id="1-单一模式"><a href="#1-单一模式" class="headerlink" title="1.单一模式"></a>1.单一模式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">单机情况下不做集群，单独运行下rabbitmq</span><br></pre></td></tr></table></figure>
<h3 id="2-普通模式"><a href="#2-普通模式" class="headerlink" title="2.普通模式"></a>2.普通模式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">普通模式也被称之为默认模式，通过两个节点（rabbitmq01、rabbitmq02）来说明，对于queue来说，消息实体只存其中的一个节点rabbitmq01或者rabbitmq02,rabbitmq01和rabbitmq02两个节点仅有相同的元数据，即队列的结构。</span><br><span class="line">rabbit01节点的Queue后consumer从rabbit02节点消费时，RabbitMQ会临时在rabbit01、rabbit02间进行消息传输，把A中的消息实体取出并经过B发送给consumer。所以consumer应尽量连接每一个节点，从中取消息。即对于同一个逻辑队列，要在多个节点建立物理Queue。否则无论consumer连rabbit01或rabbit02，出口总在rabbit01，会产生瓶颈。当rabbit01节点故障后，rabbit02节点无法取到rabbit01节点中还未消费的消息实体。如果做了消息持久化，那么得等rabbit01节点恢复，然后才可被消费；如果没有持久化的话，就会产生消息丢失的现象。</span><br></pre></td></tr></table></figure>
<h3 id="3-镜像模式"><a href="#3-镜像模式" class="headerlink" title="3.镜像模式"></a>3.镜像模式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">把需要的队列做成镜像队列，存在与多个节点属于RabbitMQ的HA方案。该模式解决了普通模式中的问题，其实质和普通模式不同之处在于，消息实体会主动在镜像节点间同步，而不是在客户端取数据时临时拉取。该模式带来的副作用也很明显，除了降低系统性能外，如果镜像队列数量过多，加之大量的消息进入，集群内部的网络带宽将会被这种同步通讯大大消耗掉。所以在对可靠性要求较高的场合中适用。</span><br></pre></td></tr></table></figure>
<h3 id="4-rabbitmq的工作流程图"><a href="#4-rabbitmq的工作流程图" class="headerlink" title="4.rabbitmq的工作流程图"></a>4.rabbitmq的工作流程图</h3><p><img src="/images/mq.png" alt="mq"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">具体说明：</span><br><span class="line">交换机的作用是接收相应的消息并且绑定到指定的队列，交换机有四种类型，分为是Direct、topic、headers、Fanout</span><br><span class="line">1）Direct是RabbitMQ默认的交换机模式,也是最简单的模式.即创建消息队列的时候,指定一个BindingKey.当发送者发送消息的时候,指定对应的Key.当Key和消息队列的BindingKey一致的时候,消息将会被发送到该消息队列</span><br><span class="line">2）topic转发信息主要是依据通配符,队列和交换机的绑定主要是依据一种模式(通配符+字符串),而当发送消息的时候,只有指定的Key和该模式相匹配的时候,消息才会被发送到该消息队列中</span><br><span class="line">3）headers也是根据一个规则进行匹配,在消息队列和交换机绑定的时候会指定一组键值对规则,而发送消息的时候也会指定一组键值对规则,当两组键值对规则相匹配的时候,消息会被发送到匹配的消息队列中</span><br><span class="line">4）Fanout是路由广播的形式,将会把消息发给绑定它的全部队列,即便设置了key,也会被忽略</span><br></pre></td></tr></table></figure>
<h2 id="二、rabbitmq的安装（基于ubuntu模式下）"><a href="#二、rabbitmq的安装（基于ubuntu模式下）" class="headerlink" title="二、rabbitmq的安装（基于ubuntu模式下）"></a>二、rabbitmq的安装（基于ubuntu模式下）</h2><h3 id="1-在线安装（自动安装）"><a href="#1-在线安装（自动安装）" class="headerlink" title="1.在线安装（自动安装）"></a>1.在线安装（自动安装）</h3><h4 id="1）自动安装"><a href="#1）自动安装" class="headerlink" title="1）自动安装"></a>1）自动安装</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install rabbitmq-server</span><br><span class="line">查看运行状态：service rabbitmq-server status</span><br></pre></td></tr></table></figure>
<h4 id="2）手动安装"><a href="#2）手动安装" class="headerlink" title="2）手动安装"></a>2）手动安装</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">创建文件夹：mkdir software</span><br><span class="line">           cd software</span><br><span class="line">获取安装包：wget http://www.rabbitmq.com/releases/rabbitmq-server/v2.7.0/rabbitmq-server-generic-unix-2.7.0.tar.gz   </span><br><span class="line">解压：tar -zxvf rabbitmq-server-generic-unix-2.7.0.tar.gz</span><br><span class="line">      cd rabbitmq_server-2.7.0/</span><br><span class="line">运行：sbin/rabbitmq-server </span><br><span class="line">查看运行状态：cd ~/software/rabbitmq_server-2.7.0/</span><br><span class="line">             sbin/rabbitmqctl status</span><br></pre></td></tr></table></figure>
<h3 id="2-离线安装"><a href="#2-离线安装" class="headerlink" title="2.离线安装"></a>2.离线安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">需要的软件包：（ncurses-6.1.tar.gz   openssl-1.0.1s.tar.gz  otp_src_19.3.tar.gz   rabbitmq-server-generic-unix-3.6.10.tar.xz）</span><br><span class="line">一、ncurses-6.1.tar.gz安装</span><br><span class="line">①tar zxvf ncurses-6.1.tar.gz</span><br><span class="line">②cd ncurses-6.1</span><br><span class="line">③./configure或者./config</span><br><span class="line">④ make</span><br><span class="line">⑤make install</span><br><span class="line">二、openssl-1.0.1s.tar.gz安装</span><br><span class="line">①tar -zvxf openssl-1.0.1s.tar.gz</span><br><span class="line">②cd openssl-1.0.1s</span><br><span class="line">③./config --prefix=/usr/local/openssl</span><br><span class="line">④修改Makefile：sudo vim Makefile(将原来的：CFLAG=     -DOPENSSL_THREADS  修改为： CFLAG= -fPIC -DOPENSSL_THREADS 也就是添加-fPIC)</span><br><span class="line">⑤make</span><br><span class="line">⑥make install</span><br><span class="line">三、otp_src_19.3.tar.gz安装</span><br><span class="line">①tar xf otp_src_19.3.tar.gz</span><br><span class="line">②cd otp_src_19.3</span><br><span class="line">③./configure --prefix=/usr/local/erlang    --with-ssl=/usr/local/openssl</span><br><span class="line">④make&amp;&amp; make install</span><br><span class="line">四、rabbitmq-server-generic-unix-3.6.10.tar.xz安装</span><br><span class="line">1.离线安装</span><br><span class="line">①tar -Jxvf rabbitmq-server-generic-unix-3.6.10.tar.xz或者tar -xvf rabbitmq-server-generic-unix-3.6.10.tar</span><br><span class="line">②cp -R rabbitmq_server-3.6.10/   /usr/local/rabbitmq/</span><br><span class="line">③chmod -R 755 /usr/local/rabbitmq/sbin</span><br><span class="line">2.rabbitmq启动</span><br><span class="line">①cd /usr/local/rabbitmq/sbin</span><br><span class="line">②./rabbitmq-server</span><br><span class="line">3.开启web管理插件</span><br><span class="line">①cd /usr/local/rabbitmq/sbin</span><br><span class="line">②./rabbitmq-plugins enable rabbitmq_management</span><br><span class="line">4.rabbitmq重启</span><br><span class="line">①cd /usr/local/rabbitmq/sbin</span><br><span class="line">②./rabbitmqctl stop   ## 停应用</span><br><span class="line">③./rabbitmq-server    ## 启动应用</span><br><span class="line">5.通过web管理</span><br><span class="line">访问http://localhost:15672</span><br><span class="line">默认用户/密码 ： guest/guest</span><br><span class="line">注意初始状态只能本地登录，不可通过远程web访问，给权限也不行。需要远程访问的，必须新建用户并赋权限。</span><br><span class="line">6.用户管理并赋权限</span><br><span class="line">①添加用户：用户名：user  密码：q1w2e3r4</span><br><span class="line">cd /usr/local/rabbitmq/sbin      ./rabbitmqctl add_user mqadmin mqadmin</span><br><span class="line">②给用户添加角色</span><br><span class="line">./rabbitmqctl set_user_tags mqadmin administrator</span><br><span class="line">③给用户授权</span><br><span class="line">./rabbitmqctl set_permissions -p / mqadmin &apos;.*&apos; &apos;.*&apos; &apos;.*&apos;</span><br><span class="line">四、安装完成之后验证erlang 是否安装成功</span><br><span class="line">① cd /usr/local/erlang</span><br><span class="line">②执行： erl -v</span><br><span class="line">③ crypto:start().  （重点：此处执行玩提示ok，说明erlang安装完成，可以继续下一步，如果提示：** exception error: undefined function crypto:start/0，需要重新安装erlang ）</span><br><span class="line">安装教程参考链接：https://segmentfault.com/a/1190000010480589</span><br><span class="line">                 https://blog.csdn.net/qq_35946990/article/details/78967660</span><br><span class="line">                 https://blog.csdn.net/u010739551/article/details/80848993</span><br><span class="line">                 https://blog.csdn.net/zhongruixian/article/details/21076405</span><br></pre></td></tr></table></figure>
<h2 id="三、rabbitmq的配置"><a href="#三、rabbitmq的配置" class="headerlink" title="三、rabbitmq的配置"></a>三、rabbitmq的配置</h2><h3 id="1-修改配置文件"><a href="#1-修改配置文件" class="headerlink" title="1.修改配置文件"></a>1.修改配置文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">通过查看服务状态：service rabbitmq-server status</span><br><span class="line">#cd /etc/rabbitmq/</span><br><span class="line">#vim rabbitmq.config</span><br><span class="line">编辑内容如下：</span><br><span class="line">[&#123;rabbit, [&#123;loopback_users, []&#125;]&#125;].</span><br><span class="line">这里的意思是开放使用，rabbitmq默认创建的用户guest，密码也是guest，这个用户默认只能是本机访问，localhost或者127.0.0.1，从外部访问需要添加上面的配置</span><br><span class="line">保存配置后重启服务：</span><br><span class="line">#service rabbitmq-server stop</span><br><span class="line">#service rabbitmq-server start</span><br></pre></td></tr></table></figure>
<h3 id="2-rabbitmq的一些基本操作"><a href="#2-rabbitmq的一些基本操作" class="headerlink" title="2.rabbitmq的一些基本操作"></a>2.rabbitmq的一些基本操作</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"># 添加开机启动RabbitMQ服务</span><br><span class="line">sudo chkconfig rabbitmq-server on</span><br><span class="line"># 启动服务</span><br><span class="line">sudo /sbin/service rabbitmq-server start </span><br><span class="line"># 查看服务状态</span><br><span class="line">sudo /sbin/service rabbitmq-server status</span><br><span class="line"># 停止服务</span><br><span class="line">sudo /sbin/service rabbitmq-server stop</span><br><span class="line"># 查看当前所有用户</span><br><span class="line">sudo rabbitmqctl list_users</span><br><span class="line"># 查看默认guest用户的权限</span><br><span class="line">sudo rabbitmqctl list_user_permissions guest</span><br><span class="line"># 由于RabbitMQ默认的账号用户名和密码都是guest。为了安全起见, 先删掉默认用户</span><br><span class="line">sudo rabbitmqctl delete_user guest</span><br><span class="line"># 添加新用户</span><br><span class="line">sudo rabbitmqctl add_user username password</span><br><span class="line"># 设置用户tag</span><br><span class="line">sudo rabbitmqctl set_user_tags username administrator</span><br><span class="line"># 赋予用户默认vhost的全部操作权限</span><br><span class="line">sudo rabbitmqctl set_permissions -p / username &quot;.*&quot; &quot;.*&quot; &quot;.*&quot;</span><br><span class="line"># 查看用户的权限</span><br><span class="line">sudo rabbitmqctl list_user_permissions username</span><br></pre></td></tr></table></figure>
<h3 id="3-开启web-管理端口"><a href="#3-开启web-管理端口" class="headerlink" title="3.开启web 管理端口"></a>3.开启web 管理端口</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo rabbitmq-plugins enable rabbitmq_management</span><br><span class="line">浏览器访问地址：http://localhost:15672</span><br></pre></td></tr></table></figure>
<h3 id="4-开启用户远程访问"><a href="#4-开启用户远程访问" class="headerlink" title="4.开启用户远程访问"></a>4.开启用户远程访问</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">默认情况下，RabbitMQ的默认的guest用户只允许本机访问， 如果想让guest用户能够远程访问的话，只需要将配置文件中的loopback_users列表置为空即可</span><br><span class="line">&#123;loopback_users, []&#125;</span><br><span class="line">更新完之后需要重启服务才能生效</span><br></pre></td></tr></table></figure>
<h2 id="四、rabbitmq使用案列说明"><a href="#四、rabbitmq使用案列说明" class="headerlink" title="四、rabbitmq使用案列说明"></a>四、rabbitmq使用案列说明</h2><h3 id="1-overview（概览选项）"><a href="#1-overview（概览选项）" class="headerlink" title="1.overview（概览选项）"></a>1.overview（概览选项）</h3><p><img src="/images/001.png" alt="001"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1）totals项：展示的是统计信息，对队列中的消息进行统计</span><br></pre></td></tr></table></figure>
<p><img src="/images/002.png" alt="002"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2）node项，这里面展示的是rabbitmq的服务节点</span><br></pre></td></tr></table></figure>
<p><img src="/images/003.png" alt="003"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">3）ports and contexts:展示的是端口信息</span><br><span class="line">这里一共有三个端口，其中5672是amqp协议的端口，15672是RabbitMQ的管理工具端口(这就是我们现在操作的)，25672是做集群的端口，如果我们现在的Java程序要与RabbitMQ进行交互，需要和哪个端口交互呢？是5672。因为Java客户端需要与RabbitMQ服务进行数据交互，必须要遵循amqp协议协议，所以要走5672端口，而15672是RabbitMQ的管理工具的端口，与服务无关，仅仅是管理工具运行的端口。</span><br></pre></td></tr></table></figure>
<p><img src="/images/004.png" alt="004"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4）export definitions:导入导出rabbitmq的基本信息</span><br></pre></td></tr></table></figure>
<p><img src="/images/005.png" alt="005"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5）总图展示</span><br></pre></td></tr></table></figure>
<p><img src="/images/mq图像.png" alt="mq图像"></p>
<h3 id="2-connections"><a href="#2-connections" class="headerlink" title="2.connections"></a>2.connections</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">客户端连接，在这里可以看客户端连接rabbitmq服务的信息</span><br></pre></td></tr></table></figure>
<p><img src="/images/006.png" alt="006"></p>
<h3 id="3-channels"><a href="#3-channels" class="headerlink" title="3.channels"></a>3.channels</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">生产者和消费者连接的通道</span><br></pre></td></tr></table></figure>
<p><img src="/images/007.png" alt="007"></p>
<h3 id="4-exchanges（收到生产者消息，准备分发的通道）"><a href="#4-exchanges（收到生产者消息，准备分发的通道）" class="headerlink" title="4.exchanges（收到生产者消息，准备分发的通道）"></a>4.exchanges（收到生产者消息，准备分发的通道）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">管理队列、交换器、绑定、解绑</span><br></pre></td></tr></table></figure>
<p><img src="/images/exchange1.png" alt="exchange1"></p>
<p><img src="/images/exhange2.png" alt="exhange2"></p>
<h3 id="5-queues（快递员）"><a href="#5-queues（快递员）" class="headerlink" title="5.queues（快递员）"></a>5.queues（快递员）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">添加队列：virtual host  name    durability  auto delete</span><br></pre></td></tr></table></figure>
<p><img src="/images/queue1.png" alt="queue1"></p>
<p><img src="/images/queue2.png" alt="queue2"></p>
<h3 id="6-admin"><a href="#6-admin" class="headerlink" title="6.admin"></a>6.admin</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">添加用户：username  pasassword  confirm  tags</span><br></pre></td></tr></table></figure>
<p><img src="/images/admin.png" alt="admin"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java中间件工具/">java中间件工具</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-ubuntu+tomcat负载均衡分布式集群配置" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/18/ubuntu+tomcat负载均衡分布式集群配置/" class="article-date">
      <time datetime="2019-03-18T10:58:30.000Z" itemprop="datePublished">2019-03-18</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/18/ubuntu+tomcat负载均衡分布式集群配置/">ubuntu+tomcat负载均衡分布式集群配置</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h2 id="一、tomcat"><a href="#一、tomcat" class="headerlink" title="一、tomcat"></a>一、tomcat</h2><h3 id="1-什么是tomcat"><a href="#1-什么是tomcat" class="headerlink" title="1.什么是tomcat"></a>1.什么是tomcat</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tomcat指的是SUN公司推出的小型Servlet/Jsp调试工具的基础上发展起来的一个优秀的Servlet容器，tomcat本身是用java语言编写，所以tomcat的运行需要java的支持，因此在运行tomcat之前必须安装号jdk</span><br></pre></td></tr></table></figure>
<h3 id="2-tomcat的目录层次结构"><a href="#2-tomcat的目录层次结构" class="headerlink" title="2.tomcat的目录层次结构"></a>2.tomcat的目录层次结构</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">bin:存放启动和关闭tomcat的脚本文件</span><br><span class="line">conf:存放tomcat服务器的各种配置文件</span><br><span class="line">lib:存放tomcat服务器支撑的jar包</span><br><span class="line">logs:存放tomcat的日志文件</span><br><span class="line">temp:存放tomcat运行时产生的临时文件</span><br><span class="line">webapps:web应用虽在目录，即供外界访问的web资源的存放目录</span><br><span class="line">work:tomcat的工作目录</span><br></pre></td></tr></table></figure>
<h2 id="二、tomcat的优化"><a href="#二、tomcat的优化" class="headerlink" title="二、tomcat的优化"></a>二、tomcat的优化</h2><h3 id="1-内存使用配置"><a href="#1-内存使用配置" class="headerlink" title="1.内存使用配置"></a>1.内存使用配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Tomcat是依赖于JVM的，所以Tomcat的使用内存配置实质上是JVM的内存配置在/bin目录下的catalina.bat可以直接通过Tomcat设置JVM内存参数,windows下打开catalina.bat文件，在大概中间的位置，找到</span><br><span class="line">set &quot;JAVA_OPTS=%JAVA_OPT% -server -Xms2048m -Xmx2048m -XX:PermSize=256m -XX:MaxPermSize=512m -Djava.awt.headless=true&quot;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-server：   模式启动应用慢，但是极大程度提高运行性能</span><br><span class="line">-Xms2048m -Xmx2048m：   设置的是堆内存</span><br></pre></td></tr></table></figure>
<h3 id="2-最大连接数配置（并发能力）"><a href="#2-最大连接数配置（并发能力）" class="headerlink" title="2.最大连接数配置（并发能力）"></a>2.最大连接数配置（并发能力）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">在/conf/server.xml里进行配置</span><br><span class="line">在&lt;Connector&gt;属性中，</span><br><span class="line">将protocol属性改为 &quot;org.apache.coyote.http11.Http11NioProtocol&quot;,NIO模型的效率更高</span><br><span class="line">加入：</span><br><span class="line">    maxThreads=&quot;500&quot; //当前可以同时处理的最大用户访问数</span><br><span class="line">    minSpareThreads=&quot;100&quot; //最小空闲线程连接数，用于优化线程池</span><br><span class="line">    maxSpareThreads=&quot;200&quot;</span><br><span class="line">    acceptCount=&quot;200&quot; //当所有的线程以分配，仍然允许连接进来，但是出于等待状态的用户数。等待线程数+工作线程数=总的可最大连接数,如果超过此数，新的连接将不会被接受，就会产生一个http错误</span><br><span class="line">    enableLookups=&quot;false&quot;//是否允许DNS反查，如果为true，request.getRemoteHost会执行DNS查找，反向解析ip对应域名或主机名，当没有这样需要的时候，可以将这个功能关闭，在一定程度上提高了Tomcat服务器的性能</span><br></pre></td></tr></table></figure>
<h2 id="三、tomcat问题处理"><a href="#三、tomcat问题处理" class="headerlink" title="三、tomcat问题处理"></a>三、tomcat问题处理</h2><h3 id="1-乱码现象"><a href="#1-乱码现象" class="headerlink" title="1.乱码现象"></a>1.乱码现象</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">对于get请求处理方式是在connector末尾处加上：URIEncoding=&quot;UTF-8&quot;</span><br><span class="line">对于post请求方式则通过设置编码：request.setCharacterEncoding(&quot;UTF-8&quot;)</span><br></pre></td></tr></table></figure>
<h3 id="2-tomcat时区问题"><a href="#2-tomcat时区问题" class="headerlink" title="2.tomcat时区问题"></a>2.tomcat时区问题</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">产生原因是因为tomcat中的时区设置与操作系统的时区设置不一致，通过修改tomcat根目录下的bin文件夹中的catalina.bat文件，增加以下配置解决问题</span><br><span class="line">set JAVA_OPTS=%JAVA_OPTS%   -Duser.timezone=GMT+08(将时区设置为北京时区)</span><br><span class="line">补充说明（date 查看日期；date +&quot;%Z %z&quot;）大Z表示的是按字母表排序的时间缩写（如，EDT）,z数字时区（例如，-0400）</span><br></pre></td></tr></table></figure>
<h2 id="四、负载均衡"><a href="#四、负载均衡" class="headerlink" title="四、负载均衡"></a>四、负载均衡</h2><h3 id="1-实现应用服务器之间的session共享"><a href="#1-实现应用服务器之间的session共享" class="headerlink" title="1.实现应用服务器之间的session共享"></a>1.实现应用服务器之间的session共享</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">保证一台服务器挂掉，另一台服务器可以继续支持工作</span><br></pre></td></tr></table></figure>
<h3 id="2-负载均衡"><a href="#2-负载均衡" class="headerlink" title="2.负载均衡"></a>2.负载均衡</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apache 进行分流，把请求的权重以及当时负荷分tomcat1 和 tomcat2...去处理</span><br></pre></td></tr></table></figure>
<h3 id="3-水平集群"><a href="#3-水平集群" class="headerlink" title="3.水平集群"></a>3.水平集群</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在不同电脑上安装tomcat，且tomcat的数量为一个，可以不必修改tomcat配置文件</span><br></pre></td></tr></table></figure>
<h3 id="4-垂直集群"><a href="#4-垂直集群" class="headerlink" title="4.垂直集群"></a>4.垂直集群</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">同一个电脑上安装两个tomcat，必须修改其中一个设置，避免端口冲突</span><br></pre></td></tr></table></figure>
<h3 id="5-正向代理"><a href="#5-正向代理" class="headerlink" title="5.正向代理"></a>5.正向代理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">客户端比较清楚自己要访问的服务器地址，服务器只清楚来自哪个代理服务器，不清楚具体是哪个客户端，正向代理屏蔽或者隐藏了真实的客户端信息</span><br></pre></td></tr></table></figure>
<h3 id="6-反向代理"><a href="#6-反向代理" class="headerlink" title="6.反向代理"></a>6.反向代理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">主要用于服务器分布集群式部署，反向代理隐藏了服务器的信息</span><br></pre></td></tr></table></figure>
<h3 id="7-nginx支持的负载均衡调度算法如下"><a href="#7-nginx支持的负载均衡调度算法如下" class="headerlink" title="7.nginx支持的负载均衡调度算法如下"></a>7.nginx支持的负载均衡调度算法如下</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.weight轮询，接收到的顺序逐一分配到不同的后端服务器，即使在使用过程中某一台服务器宕机，nginx会自动将该服务器踢出队列，请求受理情况下不回收到任何影像，可以通过设置权重值来分配受理</span><br><span class="line">2.in_pash:每个请求按照发起客户端的ip的hash结果进行匹配，这样的算法下一个固定ip地址的客户端总会访问到同一个后端服务器，这也在一定程度上解决了集群部署环境下的session共享问题</span><br><span class="line">3.fair:智能调度算法，动态的根据后端服务器的请求处理到响应的时间进行均衡分配，响应时间短处理效率高的服务器分配到请求的概率高，响应时间长处理效率低的服务器分配的请求少。nginx默认不支持这种算 法，安装好upsteam_fair就可以</span><br><span class="line">4.url_hash:按照访问的url的hash结果分配请求，每个请求的url会指向后端的固定的某个服务器，可以在nginx作为静态服务器的情况下提高缓存效率</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java中间件工具/">java中间件工具</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-terminator安装配置" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/18/terminator安装配置/" class="article-date">
      <time datetime="2019-03-18T10:58:30.000Z" itemprop="datePublished">2019-03-18</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/18/terminator安装配置/">terminator安装配置</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h2 id="一、terminator的安装"><a href="#一、terminator的安装" class="headerlink" title="一、terminator的安装"></a>一、terminator的安装</h2><h3 id="1-使用apt包管理工具轻松安装"><a href="#1-使用apt包管理工具轻松安装" class="headerlink" title="1.使用apt包管理工具轻松安装"></a>1.使用apt包管理工具轻松安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install terminator</span><br></pre></td></tr></table></figure>
<h3 id="2-美化配置"><a href="#2-美化配置" class="headerlink" title="2.美化配置"></a>2.美化配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.config/terminator/config</span><br></pre></td></tr></table></figure>
<h3 id="3-添加如下代码"><a href="#3-添加如下代码" class="headerlink" title="3.添加如下代码"></a>3.添加如下代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[global_config]</span><br><span class="line">  title_transmit_bg_color = &quot;#d30102&quot;</span><br><span class="line">  focus = system</span><br><span class="line">  suppress_multiple_term_dialog = True</span><br><span class="line">[keybindings]</span><br><span class="line">[profiles]</span><br><span class="line">  [[default]]</span><br><span class="line">    palette = &quot;#2d2d2d:#f2777a:#99cc99:#ffcc66:#6699cc:#cc99cc:#66cccc:#d3d0c8:#747369:#f2777a:#99cc99:#ffcc66:#6699cc:#cc99cc:#66cccc:#f2f0ec&quot;</span><br><span class="line">    background_color = &quot;#2D2D2D&quot; # 背景颜色</span><br><span class="line">    background_image = None   </span><br><span class="line">    background_darkness = 0.85 </span><br><span class="line">    cursor_color = &quot;#2D2D2D&quot; # 光标颜色</span><br><span class="line">    cursor_blink = True # 光标是否闪烁</span><br><span class="line">    foreground_color = &quot;#EEE9E9&quot; # 文字的颜色</span><br><span class="line">    use_system_font = False # 是否启用系统字体</span><br><span class="line">    font = Ubuntu Mono 13  # 字体设置，后面的数字表示字体大小</span><br><span class="line">    copy_on_selection = True # 选择文本时同时将数据拷贝到剪切板中</span><br><span class="line">    show_titlebar = False # 不显示标题栏，也就是 terminator 中那个默认的红色的标题栏</span><br><span class="line">[layouts]</span><br><span class="line">  [[default]]</span><br><span class="line">    [[[child1]]]</span><br><span class="line">      type = Terminal</span><br><span class="line">      parent = window0</span><br><span class="line">      profile = default</span><br><span class="line">    [[[window0]]]</span><br><span class="line">      type = Window</span><br><span class="line">      parent = &quot;&quot;</span><br><span class="line">[plugins]</span><br></pre></td></tr></table></figure>
<h2 id="二、设置不区分大小写及添加记忆"><a href="#二、设置不区分大小写及添加记忆" class="headerlink" title="二、设置不区分大小写及添加记忆"></a>二、设置不区分大小写及添加记忆</h2><h3 id="1-记录前面输入内容"><a href="#1-记录前面输入内容" class="headerlink" title="1.记录前面输入内容"></a>1.记录前面输入内容</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">进入该目录：vim ~/.bashrc</span><br><span class="line">末尾新增：</span><br><span class="line">bind &apos;&quot;\e[A&quot;: history-search-backward&apos;</span><br><span class="line">bind &apos;&quot;\e[B&quot;: history-search-forward&apos;</span><br><span class="line">完成之后必须要source刷新</span><br></pre></td></tr></table></figure>
<h3 id="2-输入时不去分大小写"><a href="#2-输入时不去分大小写" class="headerlink" title="2.输入时不去分大小写"></a>2.输入时不去分大小写</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">进入该目录：vim ~/.inputrc</span><br><span class="line">末尾新增：</span><br><span class="line">set completion-ignore-case on</span><br><span class="line">set show-all-if-ambiguous on</span><br><span class="line">完成之后必须要source刷新</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux知识块/">linux知识块</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-redis相关命令" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/18/redis相关命令/" class="article-date">
      <time datetime="2019-03-18T08:23:30.000Z" itemprop="datePublished">2019-03-18</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/18/redis相关命令/">redis相关命令</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h2 id="一、redis安装"><a href="#一、redis安装" class="headerlink" title="一、redis安装"></a>一、redis安装</h2><h3 id="1-更新软件包"><a href="#1-更新软件包" class="headerlink" title="1.更新软件包"></a>1.更新软件包</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo  apt-get install redis-server</span><br></pre></td></tr></table></figure>
<h3 id="2-安装redis-server服务端"><a href="#2-安装redis-server服务端" class="headerlink" title="2.安装redis-server服务端"></a>2.安装redis-server服务端</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install redis-server</span><br></pre></td></tr></table></figure>
<h3 id="3-查看redis系统服务进程"><a href="#3-查看redis系统服务进程" class="headerlink" title="3.查看redis系统服务进程"></a>3.查看redis系统服务进程</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -aux|grep redis</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">正常出现：</span><br><span class="line">redis     4162  0.1  0.0  10676  1420 ?        Ss   23:24   0:00 /usr/bin/redis-server /etc/redis/redis.conf</span><br><span class="line">conan     4172  0.0  0.0  11064   924 pts/0    S+   23:26   0:00 grep --color=auto redis</span><br></pre></td></tr></table></figure>
<h3 id="4-检查redis服务状态"><a href="#4-检查redis服务状态" class="headerlink" title="4.检查redis服务状态"></a>4.检查redis服务状态</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -nlt|grep 6379</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">正常出现：</span><br><span class="line">tcp        0      0 127.0.0.1:6379          0.0.0.0:*               LISTEN</span><br></pre></td></tr></table></figure>
<h3 id="5-通过启动命令检查redis服务状态"><a href="#5-通过启动命令检查redis服务状态" class="headerlink" title="5.通过启动命令检查redis服务状态"></a>5.通过启动命令检查redis服务状态</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /etc/init.d/redis-server status</span><br></pre></td></tr></table></figure>
<h3 id="6-通过命令行客户端访问redis"><a href="#6-通过命令行客户端访问redis" class="headerlink" title="6.通过命令行客户端访问redis"></a>6.通过命令行客户端访问redis</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">本机：redis-cli          然后ping出现PONG说明OK</span><br><span class="line">远程其他机器：redis-cli -h 0.0.0.0 -p 6379 -a 123456</span><br></pre></td></tr></table></figure>
<h3 id="7-redis开启允许远程访问"><a href="#7-redis开启允许远程访问" class="headerlink" title="7.redis开启允许远程访问"></a>7.redis开启允许远程访问</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/redis/redis.conf     注释掉：#bind 127.0.0.1</span><br></pre></td></tr></table></figure>
<h3 id="8-redis设置密码"><a href="#8-redis设置密码" class="headerlink" title="8.redis设置密码"></a>8.redis设置密码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/redis/redis.conf     设置：requirepass 123456</span><br></pre></td></tr></table></figure>
<h3 id="9-对于修改后生效"><a href="#9-对于修改后生效" class="headerlink" title="9.对于修改后生效"></a>9.对于修改后生效</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo /etc/init.d/redis-server restart</span><br><span class="line">Stopping redis-server: redis-server</span><br><span class="line">Starting redis-server: redis-server</span><br></pre></td></tr></table></figure>
<h2 id="二、redis的使用"><a href="#二、redis的使用" class="headerlink" title="二、redis的使用"></a>二、redis的使用</h2><h3 id="1-增加一条记录并打印该记录"><a href="#1-增加一条记录并打印该记录" class="headerlink" title="1.增加一条记录并打印该记录"></a>1.增加一条记录并打印该记录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">增加：set key1 &quot;hello&quot;</span><br><span class="line">打印：get key1</span><br></pre></td></tr></table></figure>
<h3 id="2-增加数字记录"><a href="#2-增加数字记录" class="headerlink" title="2.增加数字记录"></a>2.增加数字记录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">增加：set key2 1</span><br><span class="line">使其自增：INCR key2  INCR key2</span><br><span class="line">打印：get key2 其结果会是：“3”</span><br></pre></td></tr></table></figure>
<h3 id="3-增加一个列表记录"><a href="#3-增加一个列表记录" class="headerlink" title="3.增加一个列表记录"></a>3.增加一个列表记录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">增加：LPUSH key3 a</span><br><span class="line">从左边插入列表：LPUSH key3 b</span><br><span class="line">从右边插入列表：RPUSH key3 c</span><br><span class="line">打印列表按照从左到右顺序：LRANGE key3 0 3</span><br><span class="line">打印：“b”，“a”，“c”</span><br></pre></td></tr></table></figure>
<h3 id="4-增加一个哈希表"><a href="#4-增加一个哈希表" class="headerlink" title="4.增加一个哈希表"></a>4.增加一个哈希表</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">增加：HSET key4 name &quot;wsw&quot;</span><br><span class="line">在哈希表中插入，email的Key和Value的值：HSET key4 email &quot;abc@gmail.com&quot;</span><br><span class="line">打印哈希表中，name为key的值：HGET key4 name     结果：“wsw”</span><br><span class="line">打印整个哈希表：“name”，“wsw”，“email”，“abc@gmail.com”</span><br></pre></td></tr></table></figure>
<h3 id="5-增加一条哈希表记录"><a href="#5-增加一条哈希表记录" class="headerlink" title="5.增加一条哈希表记录"></a>5.增加一条哈希表记录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">增加一条哈希表记录key5，一次插入多个Key和value的值：HMSET key5 username antirez password P1pp0 age 3</span><br><span class="line">打印哈希表中，username和age为key的值：HMGET key5 username age</span><br><span class="line">结果：&quot;antirez&quot;  &quot;3&quot;</span><br><span class="line">打印完整的哈希表记录：HGETALL key5</span><br><span class="line">结果：</span><br><span class="line">1) &quot;username&quot;</span><br><span class="line">2) &quot;antirez&quot;</span><br><span class="line">3) &quot;password&quot;</span><br><span class="line">4) &quot;P1pp0&quot;</span><br><span class="line">5) &quot;age&quot;</span><br><span class="line">6) &quot;3&quot;</span><br></pre></td></tr></table></figure>
<h3 id="6-删除记录"><a href="#6-删除记录" class="headerlink" title="6.删除记录"></a>6.删除记录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">查看所有的key列表：keys *</span><br><span class="line">1) &quot;key2&quot;</span><br><span class="line">2) &quot;key3&quot;</span><br><span class="line">3) &quot;key4&quot;</span><br><span class="line">4) &quot;key5&quot;</span><br><span class="line">5) &quot;key1&quot;</span><br><span class="line">删除key1,key5：del key1  del key5</span><br><span class="line">查看所有的key列表：keys *</span><br><span class="line">1) &quot;key2&quot;</span><br><span class="line">2) &quot;key3&quot;</span><br><span class="line">3) &quot;key4&quot;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java中间件工具/">java中间件工具</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-docker相关命令" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/18/docker相关命令/" class="article-date">
      <time datetime="2019-03-18T04:14:30.000Z" itemprop="datePublished">2019-03-18</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/18/docker相关命令/">docker下的相关命令</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h2 id="一、首先查看ubuntu的内核版本"><a href="#一、首先查看ubuntu的内核版本" class="headerlink" title="一、首先查看ubuntu的内核版本"></a>一、首先查看ubuntu的内核版本</h2><h3 id="1-满足的情况"><a href="#1-满足的情况" class="headerlink" title="1.满足的情况"></a>1.满足的情况</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">输入命令：uname -a</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">返回：Linux wsw-desktop 4.15.0-46-generic #49~16.04.1-Ubuntu SMP Tue Feb 12 17:45:24 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">结论：可以清楚的看到我们的内盒版本为：4.15.0，本身为X86_64的内核，满足我们安装docker的需求</span><br></pre></td></tr></table></figure>
<h3 id="2-不满足的情况"><a href="#2-不满足的情况" class="headerlink" title="2.不满足的情况"></a>2.不满足的情况</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">更新源：sudo apt-get update</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">安装高版本内核：sudo apt-get install-headers-4.15.0-46-generic</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">更新grub启动加载器来加载内核：sudo update-grub</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">重启机器使用新内核：sudo reboot</span><br></pre></td></tr></table></figure>
<h2 id="二、安装docker"><a href="#二、安装docker" class="headerlink" title="二、安装docker"></a>二、安装docker</h2><h3 id="1-选择国内的云服务商，这里选择阿里云为例"><a href="#1-选择国内的云服务商，这里选择阿里云为例" class="headerlink" title="1.选择国内的云服务商，这里选择阿里云为例"></a>1.选择国内的云服务商，这里选择阿里云为例</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL http://acs-public-mirror.oss-cn-hangzhou.aliyuncs.com/docker-engine/internet | sh -</span><br></pre></td></tr></table></figure>
<h3 id="2-安装所需要的包"><a href="#2-安装所需要的包" class="headerlink" title="2.安装所需要的包"></a>2.安装所需要的包</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install linux-image-extra-$(uname -r) linux-image-extra-virtual</span><br></pre></td></tr></table></figure>
<h3 id="3-添加HTTPS传输的软件包及CA证书"><a href="#3-添加HTTPS传输的软件包及CA证书" class="headerlink" title="3.添加HTTPS传输的软件包及CA证书"></a>3.添加HTTPS传输的软件包及CA证书</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install apt-transport-https ca-certificates</span><br></pre></td></tr></table></figure>
<h3 id="4-添加GPG秘钥"><a href="#4-添加GPG秘钥" class="headerlink" title="4.添加GPG秘钥"></a>4.添加GPG秘钥</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-key adv --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D</span><br></pre></td></tr></table></figure>
<h3 id="5-添加软件源"><a href="#5-添加软件源" class="headerlink" title="5.添加软件源"></a>5.添加软件源</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;deb https://apt.dockerproject.org/repo ubuntu-xenial main&quot; | sudo tee /etc/apt/sources.list.d/docker.list</span><br></pre></td></tr></table></figure>
<h3 id="6-添加成功后更新软件包缓存"><a href="#6-添加成功后更新软件包缓存" class="headerlink" title="6.添加成功后更新软件包缓存"></a>6.添加成功后更新软件包缓存</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure>
<h3 id="7-安装docker"><a href="#7-安装docker" class="headerlink" title="7.安装docker"></a>7.安装docker</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install docker-engine</span><br></pre></td></tr></table></figure>
<h3 id="8-启动docker"><a href="#8-启动docker" class="headerlink" title="8.启动docker"></a>8.启动docker</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl enable docker</span><br><span class="line">sudo systemctl start docker</span><br></pre></td></tr></table></figure>
<h2 id="三、docker-的常用命令"><a href="#三、docker-的常用命令" class="headerlink" title="三、docker 的常用命令"></a>三、docker 的常用命令</h2><h3 id="1-从公网上拉取一个镜像"><a href="#1-从公网上拉取一个镜像" class="headerlink" title="1.从公网上拉取一个镜像"></a>1.从公网上拉取一个镜像</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull images_name</span><br></pre></td></tr></table></figure>
<h3 id="2-查看现有docker镜像"><a href="#2-查看现有docker镜像" class="headerlink" title="2.查看现有docker镜像"></a>2.查看现有docker镜像</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br><span class="line">docker container ls</span><br></pre></td></tr></table></figure>
<h3 id="3-启动一个容器"><a href="#3-启动一个容器" class="headerlink" title="3.启动一个容器"></a>3.启动一个容器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run helle-world</span><br></pre></td></tr></table></figure>
<h3 id="4-导出一个镜像"><a href="#4-导出一个镜像" class="headerlink" title="4.导出一个镜像"></a>4.导出一个镜像</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker save -o image_name.tar image_name</span><br></pre></td></tr></table></figure>
<h3 id="5-删除一个镜像"><a href="#5-删除一个镜像" class="headerlink" title="5.删除一个镜像"></a>5.删除一个镜像</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm image_name</span><br></pre></td></tr></table></figure>
<h3 id="6-查看容器端口映射情况"><a href="#6-查看容器端口映射情况" class="headerlink" title="6.查看容器端口映射情况"></a>6.查看容器端口映射情况</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker port air_redis</span><br></pre></td></tr></table></figure>
<h3 id="7-查看证在运行的容器"><a href="#7-查看证在运行的容器" class="headerlink" title="7.查看证在运行的容器"></a>7.查看证在运行的容器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps</span><br></pre></td></tr></table></figure>
<h3 id="8-查看容器pid"><a href="#8-查看容器pid" class="headerlink" title="8.查看容器pid"></a>8.查看容器pid</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker top 容器名（例如：air_test）</span><br></pre></td></tr></table></figure>
<h3 id="9-docker-容器修改镜像文件名字"><a href="#9-docker-容器修改镜像文件名字" class="headerlink" title="9.docker 容器修改镜像文件名字"></a>9.docker 容器修改镜像文件名字</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker tag imageid name:tag</span><br></pre></td></tr></table></figure>
<h2 id="四、项目实践中用到的docker"><a href="#四、项目实践中用到的docker" class="headerlink" title="四、项目实践中用到的docker"></a>四、项目实践中用到的docker</h2><h3 id="1-docker官方提供的用于构建私有的镜像仓库和官方registry镜像"><a href="#1-docker官方提供的用于构建私有的镜像仓库和官方registry镜像" class="headerlink" title="1.docker官方提供的用于构建私有的镜像仓库和官方registry镜像"></a>1.docker官方提供的用于构建私有的镜像仓库和官方registry镜像</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 5000:5000 -v /home/ubuntu/docker_repo:/var/lib/registry registry</span><br><span class="line">说明：默认情况下，仓库会被创建在容器的/var/lib/registry,可以通过-v参数来将镜像的文件存放在本地的指定路径</span><br></pre></td></tr></table></figure>
<h3 id="2-启动镜像容器"><a href="#2-启动镜像容器" class="headerlink" title="2.启动镜像容器"></a>2.启动镜像容器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start registry</span><br></pre></td></tr></table></figure>
<h3 id="3-查看docker网络"><a href="#3-查看docker网络" class="headerlink" title="3.查看docker网络"></a>3.查看docker网络</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker network ls</span><br></pre></td></tr></table></figure>
<h3 id="4-创建docker网络"><a href="#4-创建docker网络" class="headerlink" title="4.创建docker网络"></a>4.创建docker网络</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker network create air_test</span><br></pre></td></tr></table></figure>
<h3 id="5-删docker网络"><a href="#5-删docker网络" class="headerlink" title="5.删docker网络"></a>5.删docker网络</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker network rm air_rabbit</span><br><span class="line">docker network rm [id] air_test</span><br></pre></td></tr></table></figure>
<h3 id="5-查看日志"><a href="#5-查看日志" class="headerlink" title="5.查看日志"></a>5.查看日志</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">实时日志：docker logs -f -t --tail=10 &lt;容器名称&gt; </span><br><span class="line">过去某一时间点开始：docker logs --since=2019-01-01-25T11:00:00 &lt;容器名称&gt; | less   </span><br><span class="line">B向上翻页，空格向下翻页</span><br><span class="line">查看某一时间段的日志：docker logs --since 2019-01-01 &lt;容器名称&gt; | grep &apos;2019-01-02&apos;</span><br></pre></td></tr></table></figure>
<h3 id="6-进入docker容器"><a href="#6-进入docker容器" class="headerlink" title="6.进入docker容器"></a>6.进入docker容器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it &lt;容器名称&gt; /bin/bash</span><br></pre></td></tr></table></figure>
<h3 id="7-退出容器"><a href="#7-退出容器" class="headerlink" title="7.退出容器"></a>7.退出容器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">正常退出：exit</span><br><span class="line">退出后后台仍然运行：ctrl+p &amp;&amp; ctrl+q</span><br></pre></td></tr></table></figure>
<h3 id="8-docker-容器和主机文件相互拷贝"><a href="#8-docker-容器和主机文件相互拷贝" class="headerlink" title="8.docker 容器和主机文件相互拷贝"></a>8.docker 容器和主机文件相互拷贝</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">将主机的目录拷贝到容器里面：docker cp 文件名 &lt;容器名&gt;：/home/tomcat</span><br><span class="line">将容器的目录拷贝到主机上：docker cp &lt;容器名&gt;：/home/tomcat/文件名 /tmp/</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java中间件工具/">java中间件工具</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-书籍推荐" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/15/书籍推荐/" class="article-date">
      <time datetime="2019-03-15T07:08:38.000Z" itemprop="datePublished">2019-03-15</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/15/书籍推荐/">书籍推荐</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="围城"><a href="#围城" class="headerlink" title="围城"></a>围城</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">经典书评：毋庸置疑的经典之作。都说围城写婚姻，其实不然，每个阶段读都会有不同的感受，</span><br><span class="line">          婚姻，人性，人生，真实摊开，刺到骨子里，觉得人人刻薄的要命，机关算尽，可这就是现实啊。</span><br><span class="line">          最喜欢的还是书里的金句，笑点也挺多，真毒舌啊，钱老爷子真是行家啊。</span><br></pre></td></tr></table></figure>
<h3 id="小王子"><a href="#小王子" class="headerlink" title="小王子"></a>小王子</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">经典书评：如果有人钟爱着一朵独一无二的、盛开在浩瀚星海里的花。那么，当他抬头仰望繁星时，便会心满意足。</span><br><span class="line">          他会告诉自己：“我心爱的花在那里，在那颗遥远的星星上。”可是，如果羊把花吃掉了。那么，对他来说，</span><br><span class="line">          所有的星光便会在刹那间暗淡无光！而你却认为这并不重要！</span><br></pre></td></tr></table></figure>
<h3 id="活着"><a href="#活着" class="headerlink" title="活着"></a>活着</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">经典书评：生而为人，生老病死、贫穷富贵、心甘情愿、逆来顺受总是要吃苦的。横竖都是吃苦，不如吃的洒脱点儿，</span><br><span class="line">          谁能说阿Q精神全然没有可取的地方。只要活着，就有希望，要做到否极泰来要耗掉多少希望、时间，熬得过来的是英雄，</span><br><span class="line">          熬不过来的是烈士。人生好坏都是受的过程，能偷生地偷生，不能的拍拍身上尘土做点儿样子给外人看总是好的</span><br></pre></td></tr></table></figure>
<h3 id="追风筝的人"><a href="#追风筝的人" class="headerlink" title="追风筝的人"></a>追风筝的人</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">经典书评：其实每个人的生活很平淡,可能没有那样的事情让你来面对与阿米尔类似的困境.也没有人太多的人回象小说里的阿米尔那样,</span><br><span class="line">          在自己犯了错的多年以后,还能有重新赎罪的机会.现实中并没有太多机会去体会,也不会有太多的人愿意有这种机会来体会.</span><br><span class="line">          人们往往会忽视那个永远躲在角落,但是却是永远对你最亲的人.我们就是这样对待那些对自己全心全意而又别无他求的人的吗</span><br></pre></td></tr></table></figure>
<h3 id="平凡的世界"><a href="#平凡的世界" class="headerlink" title="平凡的世界"></a>平凡的世界</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">经典书评：生活没有如果，他们的命运告诉了我们。我们每个人的命运都受制于这个时代。我们不能完完全全的决定着自己的命运，</span><br><span class="line">          我们要做的是怎样让我们更幸福。有远大的理想很好，想平凡的生活也好，这只是我们追求幸福的一种途径。</span><br></pre></td></tr></table></figure>
<h3 id="倾城之恋"><a href="#倾城之恋" class="headerlink" title="倾城之恋"></a>倾城之恋</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">经典书评：《倾城之恋》主要写了白流苏和范柳原之间的爱情故事。女主人公白流苏，是一个离过婚的女人，在家族中的地位低下，</span><br><span class="line">          常遭到家人的唾骂及冷眼歧视。后来在妹妹宝络的相亲宴山遇到并爱上花花公子范柳原。于是她和范柳原展开了一场如“战争”式的恋爱。</span><br><span class="line">          在这场恋爱中他们互相猜疑，互相算计，生怕自已会陷入对方的陷阱中。后来战争爆发了，炮声冲击着整个城市，</span><br><span class="line">          他们这两个无依无靠的灵魂最终紧紧连在一起，成为乱世中的平凡夫妻。</span><br></pre></td></tr></table></figure>
<h2 id="Slow-End"><a href="#Slow-End" class="headerlink" title="Slow End"></a>Slow End</h2>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/书籍/">书籍</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-运维文档整理" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/15/运维文档整理/" class="article-date">
      <time datetime="2019-03-15T07:08:38.000Z" itemprop="datePublished">2019-03-15</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/15/运维文档整理/">运维相关文档整理</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h2 id="一、redis安装教程："><a href="#一、redis安装教程：" class="headerlink" title="一、redis安装教程："></a>一、redis安装教程：</h2><p>More info: <a href="https://jingyan.baidu.com/article/bad08e1ee14ae409c85121cf.html" target="_blank" rel="noopener">Server</a></p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; 1.下载redis链接地址：</span><br><span class="line">&gt;   wget redis-4.0.1:http://www.redis.cn/download.html</span><br><span class="line">&gt; 2.解压：</span><br><span class="line">&gt;    tar xzvf redis-4.0.1.tar.gz</span><br><span class="line">&gt; 3.开始安装：</span><br><span class="line">&gt;          ①头目录（wsw@ubuntu:~$）cd redis-4.0.1/          </span><br><span class="line">&gt;          ②~/-4.0.1$             ls</span><br><span class="line">&gt;          ③~/redis-4.0.1$  cd src/</span><br><span class="line">&gt;          ④~/redis-4.0.1$  cd src$     ls                出现很多命令行</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="二、前端node和angular安装教程"><a href="#二、前端node和angular安装教程" class="headerlink" title="二、前端node和angular安装教程"></a>二、前端node和angular安装教程</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&gt; 1.wget https://nodejs.org/dist/v10.9.0/node-v10.9.0-linux-x64.tar.xz    // 下载</span><br><span class="line">&gt; 2.tar xf  node-v10.9.0-linux-x64.tar.xz       // 解压</span><br><span class="line">&gt; 3.cd node-v10.9.0-linux-x64/                  // 进入解压目录</span><br><span class="line">&gt; 4../bin/node -v                               // 执行node命令 查看版本</span><br><span class="line">&gt; 5.v10.9.0</span><br><span class="line">&gt; 6.此处软连接路径需要根据自己情况添加设置（/home/ubuntu/software/node/bin/npm）</span><br><span class="line">&gt; ln -s /usr/software/nodejs/bin/npm   /usr/local/bin/ </span><br><span class="line">&gt; ln -s /usr/software/nodejs/bin/node   /usr/local/bin/</span><br><span class="line">&gt;</span><br><span class="line">&gt; sudo ln -s /home/ubuntu/software/node/node-v10.9.0-linux-x64/bin/npm   /usr/local/bin/</span><br><span class="line">&gt; sudo ln -s /home/ubuntu/software/node/node-v10.9.0-linux-x64/bin/node   /usr/local/bin/</span><br><span class="line">&gt;</span><br><span class="line">&gt; 7.npm -v   node -v</span><br><span class="line">&gt; 8.node 升级 （sudo npm cache clean -f   sudo npm install -g n  sudo n stable ）</span><br><span class="line">&gt; 9.node 有一个模块叫n,专门用来管理node 版本的，首先安装n模块：①npm install -g n ②n stable 三n v0.10.26</span><br><span class="line">&gt;</span><br><span class="line">&gt; 安装angular</span><br><span class="line">&gt; 1.npm install -g @angular/cli</span><br><span class="line">&gt; 2.sudo ln -s /home/ubuntu/software/node/node-v10.9.0-linux-x64/bin/ng /usr/local/bin/ng</span><br><span class="line">&gt; 3.ng -v</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
</blockquote>
<h2 id="三、rabbitmq安装教程"><a href="#三、rabbitmq安装教程" class="headerlink" title="三、rabbitmq安装教程"></a>三、rabbitmq安装教程</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&gt; 网址：https://blog.csdn.net/rickey17/article/details/72756766</span><br><span class="line">&gt; 安装步骤：</span><br><span class="line">&gt; 添加源 </span><br><span class="line">&gt; 新增公钥（不加会有警告） </span><br><span class="line">&gt; 更新源 </span><br><span class="line">&gt; 安装rabbitmq-server</span><br><span class="line">&gt; 1.</span><br><span class="line">&gt; echo &apos;deb http://www.rabbitmq.com/debian/ testing main&apos; | sudo tee /etc/apt/sources.list.d/rabbitmq.list</span><br><span class="line">&gt; wget -O- https://www.rabbitmq.com/rabbitmq-release-signing-key.asc | sudo apt-key add -</span><br><span class="line">&gt; sudo apt-get update</span><br><span class="line">&gt; sudo apt-get install rabbitmq-server</span><br><span class="line">&gt; 进入到:cd /etc/apt/sources.list.d$:路径下　执行invoke-rc.d rabbitmq-server status 查看启动状态</span><br><span class="line">&gt; 2.</span><br><span class="line">&gt; 打开管理页面 </span><br><span class="line">&gt; sudo rabbitmq-plugins enable rabbitmq_management</span><br><span class="line">&gt; 查看安装的插件 </span><br><span class="line">&gt; sudo rabbitmqctl list_users</span><br><span class="line">&gt; ar			</span><br><span class="line">&gt; 查看用户 </span><br><span class="line">&gt; sudo rabbitmqctl list_users</span><br><span class="line">&gt; 新增管理员用户 </span><br><span class="line">&gt; sudo rabbitmqctl add_user admin admin </span><br><span class="line">&gt; sudo rabbitmqctl set_user_tags admin administrator</span><br><span class="line">&gt; 3、登陆</span><br><span class="line">&gt; 4、离线安装</span><br><span class="line">&gt; 在已安装好的虚拟机上，（/var/cache/apt/archives）</span><br><span class="line">&gt; 执行:dpkg -i avg71flm_r28-1_i386.deb</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
</blockquote>
<h2 id="四、docker-相关教程"><a href="#四、docker-相关教程" class="headerlink" title="四、docker 相关教程"></a>四、docker 相关教程</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line">&gt; docker网址：https://www.cnblogs.com/shoufengwei/p/7288464.html</span><br><span class="line">&gt; 1.docker run -d -p 5000:5000 -v /home/ubuntu/docker_repo:/var/lib/registry registry</span><br><span class="line">&gt; 2.docker start registry</span><br><span class="line">&gt; 3.docker 查看网络：docker network ls</span><br><span class="line">&gt; 4.docker 创建网路：docker network create air_test</span><br><span class="line">&gt; 5.错误出现：Get https://192.168.1.100:5000/v1/_ping: http: server gave HTTP response to HTTPS client（解决：在/etc/docker/目录下，创建文件daemon.json,在文件中写入：&quot;insecure-registries&quot;:[&quot;192.168.X.X:5000&quot;]）</span><br><span class="line">&gt;</span><br><span class="line">&gt; 设置免秘钥登陆：</span><br><span class="line">&gt; 1.sslocal -c shadowsocks.json</span><br><span class="line">&gt; 2.sslocal -c shadowsocks.json &gt; /dev/null 2&gt;&amp;1 &amp;</span><br><span class="line">&gt;</span><br><span class="line">&gt; docker对后端程序进行打包升级</span><br><span class="line">&gt; 使用tomcat镜像运行容器</span><br><span class="line">&gt; 案列1：docker run --name tomcat -p 8080:8080 -v $PWD/test:/usr/local/tomcat/webapps/test -d tomacat</span><br><span class="line">&gt; 命令说明：-p 8080:8080:将容器的8080端口映射到主机的8080端口中</span><br><span class="line">&gt;          -v $PWD/test:/usr/local/tomcat/webapps/test:将主机中当前目录下的test挂在到容器的/test</span><br><span class="line">&gt;          -d tomcat:后台运行容器返回容器的id为tomcat</span><br><span class="line">&gt; 案列2：docker run -p 6699:6379 --name myredis -v $PWD/redis.conf:/etc/redis/redis.conf -v $PWD/data:/data -d redis: 3.2 redis-server /etc/redis/redis.conf --appendonly yes</span><br><span class="line">&gt; //***********************docker的安装***************************//</span><br><span class="line">&gt; 1.ubuntu 下安装docker，首先docker要求ubuntu的内核版本高于3.10，通过命令uname -r 查看ubuntu版本号</span><br><span class="line">&gt; 2.镜像加速配置：/etc/docker/daemeon.json文件里面增加“registry-mirrors”:[&quot;http://hub-mirror.c.163.com&quot;]</span><br><span class="line">&gt; 3.docker 属于c/s架构模式，通常情况下用到镜像（image）、容器（container）、仓库（repository）</span><br><span class="line">&gt; 4.查找镜像（例如查找mysql，docker search mysql ）、拉取镜像（docker pull mysql）、查看镜像（docker images）、启动镜像（docker run --name mydql1 -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7   解释：--name 是自己起的名字 、-p 映射端口、-e 用户名、-d 后台运行、mysql:5.7是依托哪个镜像哪个版本启动）、查询状态（docker ps -a）、停止容器（docker stop）、移除容器（docker rm mysql1）、查看容器完整id(docker inspect -f &apos;&#123;&#123;.Id&#125;&#125;&apos;)mysql1、进入容器内部（docker exec -it mysql1 /bin/bash）</span><br><span class="line">&gt; 5.启动一个tomcat容器，具体如下：①docker run --name tomcat -d -p 8083:8080 tomcat:latest</span><br><span class="line">&gt;   ②将打好的war包上传到tomcat 的容器里面（cp xxx.war  91dadafakfbakfbafkbafbakfba   注释：其中91dadafakfbakfbafkbafbakfba为次容器的全程，如果不知道，通过命令获取：docker inspect -f &apos;&#123;&#123;.Id&#125;&#125;&apos;tomcat）  ③然后进入容器（docker exec -it tomcat /bin/bash）④重启tomcat(docker restart tomcat)</span><br><span class="line">&gt; 6.当容器无法停止、无法删除、无法链接，docker stop,docker kill等命令都无效时①停止所有的容器（docker stop $(docker ps -q)）②强制移除容器（docker rm -f xxx）③清理容器的网络占用（格式：docker network disconnect --force 网络模式，容器名称    例子：docker network disconnect --force bridge）④重新构建容器（docker run --name mysql1 -d -p3306:3306 -e MYSQL_ROOT_PASSWORD=123456 mysql:latest）</span><br><span class="line">&gt;</span><br><span class="line">&gt;</span><br><span class="line">&gt; 命令说明: --name myredis:指定容器名称</span><br><span class="line">&gt;          --6699:6379:端口映射，redis默认端口是6379，映射成外部端口为6699</span><br><span class="line">&gt;          ---v $PWD/redis.conf:/etc/redis/redis.conf：将主机当前目录下的文件redis.conf配置映射</span><br><span class="line">&gt;          ---v $PWD/data:/data -d redis: 3.2:将主机当前目录下的data挂载到容器的data</span><br><span class="line">&gt;          --redis-server /etc/redis/redis.conf --appendonly yes:在容器执行redis-server启动命令，并打开redis持久化配置</span><br><span class="line">&gt; 需要注意的是：①如果不需要指定配置，-v $PWD/redis.conf:/etc/redis/redis.conf 可以不用</span><br><span class="line">&gt;                              ②redis-server 后面的那段 /etc/redis/redis.conf 也可以不用</span><br><span class="line">&gt;                              ③主要我是用来给redis设置了密码，我怕别人偷偷用我的redis</span><br><span class="line">&gt;                              </span><br><span class="line">&gt; docker下的一些常用软件安装：</span><br><span class="line">&gt; -----------------------------mongo安装教程-------------------------------</span><br><span class="line">&gt; 1. 网址：https://www.mongodb.com/download-center#community</span><br><span class="line">&gt; ①查找Docker Hub上的mongo镜像：docker search mongo</span><br><span class="line">&gt; ②docker pull mongo：3.6</span><br><span class="line">&gt; ③docker images ls</span><br><span class="line">&gt; ④sudo docker run --name air_mongo -p 27018:27017 -v /data/test_volume/mongo_volume:/data/db -d mongo:3.6</span><br><span class="line">&gt; ⑤sudo docker ps</span><br><span class="line">&gt; ⑥sudo docker exec -it air_mongo /bin/bash</span><br><span class="line">&gt; ⑦测试mongo:sudo docker run -it mongo:3.6 mongo --host 172.17.0.1:27018</span><br><span class="line">&gt;</span><br><span class="line">&gt; ---------------------------rabbitmq安装教程------------------------------</span><br><span class="line">&gt; ①查找镜像：sudo docker search rabbitmq</span><br><span class="line">&gt; ②docker pull rabbitmq:management</span><br><span class="line">&gt; ③docker images ls</span><br><span class="line">&gt; ④sudo docker run -d --name air_rabbit --hostname my-rabbit -p 15672:15672 -p 5672:5672 -eRABBITMQ_DEFAULT_USER=user -e RABBITMQ_DEFAULT_PASS=q1w2e3r4 rabbitmq:management</span><br><span class="line">&gt; ⑤查看端口：netstat -nlt|grep 15672</span><br><span class="line">&gt;</span><br><span class="line">&gt; --------------------------redis安装教程---------------------------------</span><br><span class="line">&gt; ①查找镜像：sudo docker search redis</span><br><span class="line">&gt; ②sudo docker pull redis:3.2</span><br><span class="line">&gt; ③docker images ls</span><br><span class="line">&gt; ④sudo docker run --name air_redis -p 6379:6379 -e REDIS_USER=admin -e REDIS_PASSWORD=admin123 -v /data/test_volume/redis_volume:/data -d redis:3.2（需要把路径建好）</span><br><span class="line">&gt; ⑤进入容器：sudo docker exec -it air_redis /bin/bash</span><br><span class="line">&gt; ⑥产看端口：netstat -nlt|grep 6379</span><br><span class="line">&gt; ⑦sudo docker exec -it air_redis redis-cli</span><br><span class="line">&gt; ⑧远程访问redis:redis-cli -h 191.168.1.130 -p 6379(必须找一台装了redis-cli的机器访问)</span><br><span class="line">&gt;</span><br><span class="line">&gt; ------------------------redis连接不上，需要重启-----------------------</span><br><span class="line">&gt; ①重启redis:redis-server redis.conf &gt;/dev/null 2&gt;&amp;1 &amp;</span><br><span class="line">&gt; ②查看redis端口: ps -ef |grep redis</span><br><span class="line">&gt; ③查看服务器别人历史输入命令:history</span><br><span class="line">&gt;</span><br><span class="line">&gt; -------------------------rocket.chat安装教程---------------------------</span><br><span class="line">&gt; 网址：http://blog.topspeedsnail.com/archives/8626</span><br><span class="line">&gt; sudo apt install docker-compose</span><br><span class="line">&gt; git clone https://github.com/RocketChat/Rocket.Chat</span><br><span class="line">&gt; cd Rocket.Chat</span><br><span class="line">&gt; docker-compose up</span><br><span class="line">&gt; http://yourhost_ip:3000</span><br><span class="line">&gt;</span><br><span class="line">&gt; -------------------------docker compose安装教程------------------------</span><br><span class="line">&gt; 一、安装</span><br><span class="line">&gt; ①运行此命令安装最新版本的Docker Compose:sudo curl -L https://github.com/docker/compose/releases/download/1.22.0/docker-compose-$(uname -s)-$(uname -m) -o /usr/local/bin/docker-compose</span><br><span class="line">&gt; ②对二进制文件应用可执行权限：sudo chmod +x /usr/local/bin/docker-compose</span><br><span class="line">&gt; ③测试安装：docker-compose --version（输出：docker-compose version 1.22.0, build 1719ceb）说明安装成功</span><br><span class="line">&gt; 二、升级</span><br><span class="line">&gt; ①直接升级：docker-compose migrate-to-labels</span><br><span class="line">&gt; ②不需要保留：docker container rm -f -v myapp_web_1 myapp_db_1 ...</span><br><span class="line">&gt; 三、卸载</span><br><span class="line">&gt; ①如果安装使用，则卸载Docker Compose curl:sudo rm /usr/local/bin/docker-compose</span><br><span class="line">&gt; ②如果安装使用，则卸载Docker Compose pip:pip uninstall docker-compose</span><br><span class="line">&gt;</span><br><span class="line">&gt; ----------------------执行docker-compose up----------------------------</span><br><span class="line">&gt; 出现错误：Couldn&apos;t connect to Docker daemon at http+unix://var/run/docker.sock - is it running?   If it&apos;s at a non-standard location, specify the URL with the DOCKER_HOST environment variable</span><br><span class="line">&gt; 解决方法：</span><br><span class="line">&gt; ①编辑sudo vim /etc/default/docker文件，加入：</span><br><span class="line">&gt; DOCKER_OPTS=&quot;-H tcp://127.0.0.1:4243 -H unix:///var/run/docker.sock&quot;</span><br><span class="line">&gt; ②重启docker服务：</span><br><span class="line">&gt; sudo service docker restart</span><br><span class="line">&gt; ③检查并确定 Docker 运行在 localhost:4243：</span><br><span class="line">&gt; netstat -ant  |grep 4243</span><br><span class="line">&gt; tcp        0      0 127.0.0.1:4243          0.0.0.0:*               LISTEN</span><br><span class="line">&gt; ④设置 DOCKER_HOST 环境变量，可以添加到 ~/.bashrc 文件中</span><br><span class="line">&gt; export DOCKER_HOST=tcp://localhost:4243</span><br><span class="line">&gt;</span><br><span class="line">&gt;</span><br><span class="line">&gt; -----------------新环境下直接利用docker　pull文件------------------------------</span><br><span class="line">&gt; sudo docker network ls</span><br><span class="line">&gt; docker run -d --name air_rabbit --network air_test --hostname my-rabbit --volume rabbit_volume:/var/lib/rabbitmq -p 15672:15672 -p 5672:5672 -e RABBITMQ_DEFAULT_USER=user -e RABBITMQ_DEFAULT_PASS=q1w2e3r4 rabbitmq:management</span><br><span class="line">&gt; sudo docker run -d --name air_rabbit --network air_test --hostname my-rabbit --volume rabbit_volume:/var/lib/rabbitmq -p 15672:15672 -p 5672:5672 -e RABBITMQ_DEFAULT_USER=user -e RABBITMQ_DEFAULT_PASS=q1w2e3r4 rabbitmq:management</span><br><span class="line">&gt; docker network create --driver=bridge  --subnet=172.18.0.0/16 --gateway=172.18.0.1  air_test</span><br><span class="line">&gt; sudo docker network create --driver=bridge  --subnet=172.18.0.0/16 --gateway=172.18.0.1  air_test</span><br><span class="line">&gt; sudo docker run -d --name air_rabbit --network air_test --hostname my-rabbit --volume rabbit_volume:/var/lib/rabbitmq -p 15672:15672 -p 5672:5672 -e RABBITMQ_DEFAULT_USER=user -e RABBITMQ_DEFAULT_PASS=q1w2e3r4 rabbitmq:management</span><br><span class="line">&gt; docker run --name air_redis --network air_test -p 6379:6379 -v /data/test_volume/redis_volume:/data -d redis:4.0 --requirepass &quot;123456&quot;</span><br><span class="line">&gt; sudo docker run --name air_redis --network air_test -p 6379:6379 -v /data/test_volume/redis_volume:/data -d redis:4.0 --requirepass &quot;123456&quot;</span><br><span class="line">&gt; sudo docker run --name air_mongo -p 27017:27017 --network air_test  -v /etc/localtime:/etc/localtime -v /data/test_volume/mongo_volume:/data/db -d swifthealth/mongo_3.6</span><br><span class="line">&gt;</span><br><span class="line">&gt; -----------docker实时查看日志或者查看某一天的日志-----------</span><br><span class="line">&gt; 1.查看实时日志：</span><br><span class="line">&gt;</span><br><span class="line">&gt; docker logs -f -t --tail=10 &lt;容器名称&gt;</span><br><span class="line">&gt; e.g:$ docker logs -f -t --tail=10 sync_api</span><br><span class="line">&gt; 2.查看从过去某一时间点开始的日志</span><br><span class="line">&gt; B:向上翻页  空格：向下翻页</span><br><span class="line">&gt; $ docker logs  --since=2019-01-25T11:00:00   &lt;容器名称&gt;   | less</span><br><span class="line">&gt; 3.查看最近30分钟的日志</span><br><span class="line">&gt; $ docker logs --since 30m &lt;容器名称&gt;  | less</span><br><span class="line">&gt; 4.查看过去某一时间点到另一时间点的日志</span><br><span class="line">&gt; e.g:查看sync_api 2019-1-26 12 点到14点的日志</span><br><span class="line">&gt; $ docker logs --since 2019-01-25 sync_api | grep &apos;2019-01-26 1[2-4]&apos;</span><br><span class="line">&gt;</span><br><span class="line">&gt; 一、修改免密码登陆文件（cd ~/.ssh/   vim authorized_keys）</span><br><span class="line">&gt; 二、修改可访问的路径和文件权限 （cd 目标目录  sudo chmod -R o+rx 目录）</span><br><span class="line">&gt; 三、添加jdyyy用户（sudo useradd -m -s /bin/bash jdyyy   sudo passwd jdyyy）</span><br><span class="line">&gt; 四、修改ubuntu用户密码 （sudo passwd ubuntu）</span><br><span class="line">&gt;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
</blockquote>
<h2 id="五、ubuntu下关闭终端使程序后台运行命令"><a href="#五、ubuntu下关闭终端使程序后台运行命令" class="headerlink" title="五、ubuntu下关闭终端使程序后台运行命令"></a>五、ubuntu下关闭终端使程序后台运行命令</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt; 1.nohup 和 &amp;命令一起使用：nohup command &amp;</span><br><span class="line">&gt; 例子：nohup /usr/local/node/bin/node /www/im/chat.js &gt;&gt; /usr/loacal/node/output.log 2&gt;&amp;1 &amp;</span><br><span class="line">&gt; ①查看运行的后台进程：jobs -l（注：jobs命令只看当前终端生效的，关闭终端后，在另一个终端jobs已经无法看到后台跑的程序了，此时利用ps查看进程命令）</span><br><span class="line">&gt; ps -ef</span><br><span class="line">&gt; ps -aux|grep shadowsocks.json (a:显示所有程序,u:以用户为主的格式来显示,x:显示所有程序，不以终端机来区分)</span><br><span class="line">&gt; ps -aux|grep shadowsocks.json| grep -v grep | awk &apos;&#123;print $2&#125;&apos;(解释：grep -v参数可以将grep命令排除掉，awk提取一下进程ID)</span><br><span class="line">&gt; ②查看使用某端口的进程：lsof -i:8080   netstat -ap|grep 8080  </span><br><span class="line">&gt; ③查看到进程id之后，使用netstat命令查看其占用的端口 ：netstat -nap|grep 7799</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
</blockquote>
<h2 id="六、tomcat相关配置说明"><a href="#六、tomcat相关配置说明" class="headerlink" title="六、tomcat相关配置说明"></a>六、tomcat相关配置说明</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&gt; -------------解决tomcat中文乱码现象---------</span><br><span class="line">&gt; tomcat7之前使用的格式是：iso8895-1 ,自身不能显示中文，</span><br><span class="line">&gt; tomcat8以后默认编码格式是utf-8</span><br><span class="line">&gt; 对于get请求处理方式是在connector末尾处加上：URIEncoding=&quot;UTF-8&quot;</span><br><span class="line">&gt; 对于post请求方式则通过设置编码：request.setCharacterEncoding(&quot;UTF-8&quot;)</span><br><span class="line">&gt;</span><br><span class="line">&gt; --------------修改tomcat时区问题------------</span><br><span class="line">&gt; 比我们的系统时区慢8小时，应该如何处理</span><br><span class="line">&gt; 解决办法：产生原因是因为tomcat中的时区设置与操作系统的时区设置不一致，通过修改tomcat根目录下的bin文件夹中的catalina.bat文件，增加以下配置解决问题</span><br><span class="line">&gt; set JAVA_OPTS=%JAVA_OPTS%   -Duser.timezone=GMT+08(将时区设置为北京时区)</span><br><span class="line">&gt; 补充说明（date 查看日期；date +&quot;%Z %z&quot;）大Z表示的是按字母表排序的时间缩写（如，EDT）,z数字时区（例如，-0400）</span><br><span class="line">&gt; -------------apache+tomcat负载均衡分布式集群配置-------------------</span><br><span class="line">&gt; ①实现应用服务器之间的session共享：（保证一台服务器挂掉，另一台服务器可以继续支持工作）</span><br><span class="line">&gt; ②负载均衡</span><br><span class="line">&gt; apache 进行分流，把请求的权重以及当时负荷分tomcat1 和 tomcat2...去处理</span><br><span class="line">&gt; ③水平集群，指的是在不同电脑上安装tomcat，且tomcat的数量为一个，可以不必修改tomcat配置文件</span><br><span class="line">&gt;   垂直集群，指的是同一个电脑上安装两个tomcat，必须修改其中一个设置，避免端口冲突</span><br><span class="line">&gt;   </span><br><span class="line">&gt; ④代理：正向代理（客户端比较清楚自己要访问的服务器地址，服务器只清楚来自哪个代理服务器，不清楚具体是哪个客户端，正向代理屏蔽或者隐藏了真实的客户端信息）</span><br><span class="line">&gt;         反向代理（主要用于服务器分布集群式部署，反向代理隐藏了服务器的信息）</span><br><span class="line">&gt; ⑤nginx支持的负载均衡调度算法如下（1.weight轮询，接收到的顺序逐一分配到不同的后端服务器，即使在使用过程中某一台服务器宕机，nginx会自动将该服务器踢出队列，请求受理情况下不回收到任何影像，可以通过设置权重值来分配受理</span><br><span class="line">&gt;                                  2.in_pash:每个请求按照发起客户端的ip的hash结果进行匹配，这样的算法下一个固定ip地址的客户端总会访问到同一个后端服务器，这也在一定程度上解决了集群部署环境下的session共享问题</span><br><span class="line">&gt;                                  3.fair:智能调度算法，动态的根据后端服务器的请求处理到响应的时间进行均衡分配，响应时间短处理效率高的服务器分配到请求的概率高，响应时间长处理效率低的服务器分配的请求少。nginx默认不支持这种算 法，安装好upsteam_fair就可以，4.url_hash:按照访问的url的hash结果分配请求，每个请求的url会指向后端的固定的某个服务器，可以在nginx作为静态服务器的情况下提高缓存效率）</span><br><span class="line">&gt;</span><br><span class="line">&gt; --------------------ubuntu16.04系统连接数超限解决方法----------------------------</span><br><span class="line">&gt; 修改ubuntu16.04文件数、进程数限制，近日进行HBase全分布部署，要修改ubuntu16.04默认资源限制</span><br><span class="line">&gt; 终端修改：sudo vim /etc/security/limits.conf文件，</span><br><span class="line">&gt; 增加：root   soft   nofile   10240</span><br><span class="line">&gt;       root   hard   nofile   10240</span><br><span class="line">&gt;       root   soft   noproc   10240</span><br><span class="line">&gt;       root   hard   noproc   10240</span><br><span class="line">&gt; 保存后，在输入ulimit -n 10240 即可生效   ，最后用ulimie a 查看</span><br><span class="line">&gt; 查看服务器连接数：netstat -n|wc -l</span><br><span class="line">&gt; 有效的连接数：netstat -nat|grep ESTABLISHED|wc -l</span><br><span class="line">&gt; ------------------git 拉代码报错，只需执行-----------</span><br><span class="line">&gt; eval &quot;$(ssh-agent -s)&quot;</span><br><span class="line">&gt; ssh-add</span><br><span class="line">&gt; --------------修改完hosts和hostname文件，立即生效命令-------------</span><br><span class="line">&gt; sudo /etc/init.d/hostname.sh start</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
</blockquote>
<h2 id="七、git上代码的合并等内容"><a href="#七、git上代码的合并等内容" class="headerlink" title="七、git上代码的合并等内容"></a>七、git上代码的合并等内容</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&gt; -------------合并代码到master分支上----------</span><br><span class="line">&gt; 1.加入我们现在在刚刚开发完的dev分之上</span><br><span class="line">&gt; git add .</span><br><span class="line">&gt; git commit -m &apos;dev&apos;</span><br><span class="line">&gt; git push -u origin dev</span><br><span class="line">&gt; 2.我们要把dev分支的代码合并到master分之上，该如何？首先切换到master分支上</span><br><span class="line">&gt; git checkout master</span><br><span class="line">&gt; 3.如果多人开发，需要把远程master上的代码pull下来</span><br><span class="line">&gt; git pull origin master</span><br><span class="line">&gt; 4.如果自己一个开发就没必要，为了保险期间还是pull,然后我们把dev分支的代码合并到master上</span><br><span class="line">&gt; git merge dev</span><br><span class="line">&gt; 5.然后查看状态</span><br><span class="line">&gt; git status</span><br><span class="line">&gt; (On branch master</span><br><span class="line">&gt;  Your branch is ahead of &apos;origin/master&apos;by 12 commits.</span><br><span class="line">&gt;  (use &quot;git push&quot; to publish your local commits)</span><br><span class="line">&gt;  nothing to commit,working tree clean</span><br><span class="line">&gt; 上面的意思就是你有12个commit,需要push到远程master上，执行下面命令即可</span><br><span class="line">&gt; )</span><br><span class="line">&gt; git push origin master</span><br><span class="line">&gt; tar xf 解压（遇错：error is not recoverable:exiting now）</span><br><span class="line">&gt; 远程连接：sudo apt-get install openssh-server</span><br><span class="line">&gt;</span><br><span class="line">&gt; ------------idea中git用户名的修改---------------</span><br><span class="line">&gt; 查看当前用户：git config user.name</span><br><span class="line">&gt; 修改用户名输入：git config --global user.name &quot;用户名&quot;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
</blockquote>
<h2 id="八、oracle数据库相关"><a href="#八、oracle数据库相关" class="headerlink" title="八、oracle数据库相关"></a>八、oracle数据库相关</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&gt; ------------oracle数据库死锁查看并解锁--------------</span><br><span class="line">&gt; 查看死锁：</span><br><span class="line">&gt; select object_name,machine,s.sid,s.serial#</span><br><span class="line">&gt; from v$locked_object l,dba_objects o ,v$session s</span><br><span class="line">&gt; where l.object_id　=　o.object_id and l.session_id=s.sid;</span><br><span class="line">&gt; 解锁：</span><br><span class="line">&gt; alter system kill session &apos;48,2030&apos;;</span><br><span class="line">&gt;</span><br><span class="line">&gt; ------------数据库查询结果拼接-------------------</span><br><span class="line">&gt; SELECT to_char(operatetime,&apos;yyyy&apos;) || TRIM(LEADING &apos;0&apos; FROM TO_CHAR(OPERATETIME,&apos;MM&apos;)) || &apos;/&apos; || checkserialnum ||&apos;/&apos; || pacspath FROM pda.pda_pacsimage WHERE CHECKSERIALNUM=&apos;20180818000914&apos;;</span><br><span class="line">&gt;</span><br><span class="line">&gt; ------------ORACLE查询session连接数和inactive--------------</span><br><span class="line">&gt; 1.查看当前总会话数和进程数</span><br><span class="line">&gt; 当前session的连接数：select count(*) from v$session</span><br><span class="line">&gt; 当前的数据库连接数：select count(*) from v$process</span><br><span class="line">&gt; 查询数据允许的最大连接数：select value from v$parameter where name = &apos;process&apos;</span><br><span class="line">&gt; 修改数据库的最大连接数：alter system set processes = 3-- scope = spfile</span><br><span class="line">&gt; 当前并发的连接数：select count(*) from v$session where status = &apos;ACTIVE&apos;</span><br><span class="line">&gt;</span><br><span class="line">&gt; 2.查询哪些用户的连接数是多少</span><br><span class="line">&gt; select b.MACHINE,b.PROGRAM,count(*) FROM V$PROCESS a,V$SESSION b WHERE a.PADDR = b.USERNAME IS NOT NULL GROUP BY B.MACHINE,B.PROGRAM ODESR BY COUNT(*) DESC</span><br><span class="line">&gt;</span><br><span class="line">&gt; 3.查询是否死锁</span><br><span class="line">&gt; select * from v$locked_object</span><br><span class="line">&gt;</span><br><span class="line">&gt; 4.重启和关闭数据库</span><br><span class="line">&gt; 关闭数据库：shutdown immediate</span><br><span class="line">&gt; 重启数据库：startup</span><br><span class="line">&gt;</span><br><span class="line">&gt; -----------oracle数据库学习-------------</span><br><span class="line">&gt; 1.什么是存储过程，存储过程的作用（存储过程是一种为了完成特定功能的SQL语句集，编译后存储在数据库中，用户通过指定存储过程的名字并给参数来执行它）</span><br><span class="line">&gt; 2.存储过程的特点：①只在创造时进行编译，以后每次执行都不需要编译，而一般的SQL语句执行一次就得编译一次，因此使用存储过程可以提高数据库执行速度，②当数据库进行复杂操作时，如多个表进行UPDATE INSERT QUERY DELETE,便可以用存储过程封装，③与数据库提供的事务处理结合在一起，④安全性高，可以设定只有某个用户才具有对指定存储过程的使用权限</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
</blockquote>
<h2 id="九、pg数据库"><a href="#九、pg数据库" class="headerlink" title="九、pg数据库"></a>九、pg数据库</h2><blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&gt; ----------postgresql中将查询出来的字段转换成数组，带&#123;&#125;的方法------------</span><br><span class="line">&gt; SELECT (string_to_array((select special from sys_doctor where doctor_code =&apos;006641&apos;),&apos;&apos;))  FROM sys_doctor t where t.doctor_code=&apos;006641&apos;;</span><br><span class="line">&gt;</span><br><span class="line">&gt; ----------对pg数据库表进行清空操作-----------</span><br><span class="line">&gt; TRUNCATE TABLE SYS_DICTIONARY_MAPPING</span><br><span class="line">&gt;</span><br><span class="line">&gt; ----------pg杀死进程sql-----------</span><br><span class="line">&gt; 查询表中存在的锁</span><br><span class="line">&gt; select a.locktype,a.database,a.pid,a.mode,a.relation,b.relname</span><br><span class="line">&gt; from pg_locks a</span><br><span class="line">&gt; join pg_class b on a.relation = b.oid</span><br><span class="line">&gt; where b.relname = &apos;&apos;;</span><br><span class="line">&gt;</span><br><span class="line">&gt; 以上为查询某表上是否存在锁的SQL语句。</span><br><span class="line">&gt; 查到后发现确实存在锁，如下：</span><br><span class="line">&gt;</span><br><span class="line">&gt;  locktype | database |  pid  |      mode      | relation | relname</span><br><span class="line">&gt;</span><br><span class="line">&gt; ----------+----------+-------+-----------------+----------+---------</span><br><span class="line">&gt;</span><br><span class="line">&gt;  relation |  439791 | 26752 | AccessShareLock |  2851428 |table_name</span><br><span class="line">&gt;</span><br><span class="line">&gt;  relation |  439791 | 26752 | ExclusiveLock  |  2851428 |table_name</span><br><span class="line">&gt;</span><br><span class="line">&gt; 再根据上面查出来的pid去表pg_stat_activity查询一下该锁对应的SQL语句：</span><br><span class="line">&gt; select usename,current_query ,query_start,procpid,client_addr from pg_stat_activity where procpid=17509;</span><br><span class="line">&gt;</span><br><span class="line">&gt; 如下：</span><br><span class="line">&gt;</span><br><span class="line">&gt;   usename  |  current_query                      |          query_start          | procpid |  client_addr</span><br><span class="line">&gt;</span><br><span class="line">&gt; -----------+---------------------------------------------------------------------------------------------------------------+-------------------------------+---------+----------------</span><br><span class="line">&gt;</span><br><span class="line">&gt;  gpcluster | DELETE FROM TABLE_NAME WHERE A = 1  | 2011-05-14 09:35:47.721173+08 |  17509 | 192.168.165.18</span><br><span class="line">&gt; (1 row)</span><br><span class="line">&gt; kill有两种方式，第一种是：</span><br><span class="line">&gt; SELECT pg_cancel_backend(PID);</span><br><span class="line">&gt; 这种方式只能kill select查询，对update、delete 及DML不生效)</span><br><span class="line">&gt; 第二种是：</span><br><span class="line">&gt; SELECT pg_terminate_backend(PID);</span><br><span class="line">&gt; 这种可以kill掉各种操作(select、update、delete、drop等)操作</span><br><span class="line">&gt;</span><br><span class="line">&gt;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/运维参考/">运维参考</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-安装hexo" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/03/14/安装hexo/" class="article-date">
      <time datetime="2019-03-14T07:15:30.000Z" itemprop="datePublished">2019-03-14</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/14/安装hexo/">安装hexo</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="配置Github"><a href="#配置Github" class="headerlink" title="配置Github"></a>配置Github</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">   建立与你用户名相对应仓库，仓库名必须是 yourusername.github.io，固定写</span><br><span class="line">``` </span><br><span class="line">### 安装Hexo</span><br></pre></td></tr></table></figure>
<p>   Node和Git都安装好后,首先创建一个文件夹,如blog,用户存放hexo的配置文件,然后进入blog里安装Hexo<br>   sudo npm install-g hexo<br>   <strong> 执行init命令初始化hexo,命令：</strong><br>   hexo init<br>   <strong> 生成静态页面</strong><br>   hexo generate<br>   <strong> 启动本地服务，进行文章预览调试，命令：</strong><br>   hexo server<br>   <strong> 浏览器输入 <a href="http://0.0.0.0:4000/" target="_blank" rel="noopener">http://0.0.0.0:4000/</a> 就可以看到很丑的默认初始页了 </strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">### hexo与github关联</span><br></pre></td></tr></table></figure></p>
<p>  <strong> 在本地找到 _config.yml 文件 </strong><br>  文件底部有这样的属性：<br>  deploy:</p>
<p>  type:               修改为：<br>  deploy:</p>
<p>  type: git</p>
<p>  repo: <a href="https://github.com/你在github的根路径/你建立的仓库名.git" target="_blank" rel="noopener">https://github.com/你在github的根路径/你建立的仓库名.git</a></p>
<p>  branch: master<br>  <strong> 本地文件推送到github </strong><br>  hexo generate (生成静态页面)</p>
<p>  hexo deploy (远程推送)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">### 美化博客</span><br></pre></td></tr></table></figure></p>
<p>   <strong> hexo有很多配套主题，可自行百度并都有配置文档 </strong><br>   头像图片、作者名字、网站描述等网站基本属性都在根目录的_config.yml文件里配置<br>   评论、搜索、统计、等功能配置都在主题文件的_config.yml文件里配置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">### 发表文章</span><br></pre></td></tr></table></figure></p>
<p>   <strong> 新建文章命令后: </strong><br>   hexo new “文章名”<br>   在source/_posts会生成后缀名为.md的文件，支持markdown语法，里面可以设置标签名、分类名、是否开启评论功能等（markdown语法冒号后加空格）<br><code>`</code><br>More info: <a href="https://www.jianshu.com/p/6bb5e2983016" target="_blank" rel="noopener">Writing</a></p>
<h2 id="Slow-End"><a href="#Slow-End" class="headerlink" title="Slow End"></a>Slow End</h2>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/运维参考/">运维参考</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  

</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2019 天纵旺才
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo &nbsp;&nbsp;</a><a href="https://github.com/maochunguang" target="_blank">Blog</a> by tommy
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style="display:none">
                        <span id="site-visit">极客到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style="display:none">
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 1;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'xxxxx', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?xxxxxx";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>



<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(
            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>